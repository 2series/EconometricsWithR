<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Using R for Introduction to Econometrics</title>
  <meta name="description" content="Using <tt>R</tt> for Introduction to Econometrics">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Using R for Introduction to Econometrics" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="Emwikts1970/URFITE-Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Using R for Introduction to Econometrics" />
  
  
  

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber and Martin Schmelzer">


<meta name="date" content="2018-07-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="analysis-of-the-test-score-data-set.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="js/hideOutput.js"></script>
<script type="text/javascript" src="MathJax-2.7.2/MathJax.js?config=default"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script async defer src="https://hypothes.is/embed.js"></script>

<!-- datacamp-light-latest -->

<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>


<!-- <script src="js/d3.v3.min.js"></script>
<script src="js/leastsquares.js"></script>
<script src="js/d3functions.js"></script>
<script src="d3.slider.js"></script>
<script src="slrm.js"></script> -->


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">URFITE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="a-very-short-introduction-to-r-and-rstudio.html"><a href="a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.1</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="htaciimr.html"><a href="htaciimr.html"><i class="fa fa-check"></i><b>2</b> Hypothesis Tests and Confidence Intervals in Multiple Regression</a><ul>
<li class="chapter" data-level="2.1" data-path="hypothesis-tests-and-confidence-intervals-for-a-single-coefficient.html"><a href="hypothesis-tests-and-confidence-intervals-for-a-single-coefficient.html"><i class="fa fa-check"></i><b>2.1</b> Hypothesis Tests and Confidence Intervals for a Single Coefficient</a></li>
<li class="chapter" data-level="2.2" data-path="an-application-to-test-scores-and-the-student-teacher-ratio.html"><a href="an-application-to-test-scores-and-the-student-teacher-ratio.html"><i class="fa fa-check"></i><b>2.2</b> An Application to Test Scores and the Student-Teacher Ratio</a><ul>
<li class="chapter" data-level="" data-path="an-application-to-test-scores-and-the-student-teacher-ratio.html"><a href="an-application-to-test-scores-and-the-student-teacher-ratio.html#another-augmentation-of-the-model"><i class="fa fa-check"></i>Another Augmentation of the Model</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="joint-hypothesis-testing-using-the-f-statistic.html"><a href="joint-hypothesis-testing-using-the-f-statistic.html"><i class="fa fa-check"></i><b>2.3</b> Joint Hypothesis Testing Using the F-Statistic</a></li>
<li class="chapter" data-level="2.4" data-path="confidence-sets-for-multiple-coefficients.html"><a href="confidence-sets-for-multiple-coefficients.html"><i class="fa fa-check"></i><b>2.4</b> Confidence Sets for Multiple Coefficients</a></li>
<li class="chapter" data-level="2.5" data-path="model-specification-for-multiple-regression.html"><a href="model-specification-for-multiple-regression.html"><i class="fa fa-check"></i><b>2.5</b> Model Specification for Multiple Regression</a><ul>
<li class="chapter" data-level="" data-path="model-specification-for-multiple-regression.html"><a href="model-specification-for-multiple-regression.html#model-specification-in-theory-and-in-practice"><i class="fa fa-check"></i>Model Specification in Theory and in Practice</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="analysis-of-the-test-score-data-set.html"><a href="analysis-of-the-test-score-data-set.html"><i class="fa fa-check"></i><b>2.6</b> Analysis of the Test Score Data Set</a></li>
<li class="chapter" data-level="2.7" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.7</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using <tt>R</tt> for Introduction to Econometrics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. You can also see the annotations of others: click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="exercises" class="section level2">
<h2><span class="header-section-number">2.7</span> Exercises</h2>
<div class="DCexercise">
<h4 id="hypothesis-testing-in-a-multiple-regression-model---t-statistics-and-p-values" class="unnumbered">1. Hypothesis Testing in a Multiple Regression Model - t-statistics and p-values</h4>
<p>Reconsider the <tt>Boston</tt> data set and the following estimated model (with homoscedasticity-only standard errors in parentheses) from the previous chapter:</p>
<p><span class="math display">\[\widehat{medv}_i = \underset{(0.75)}{32.828} \underset{(0.05)}{-0.994} \times lstat_i \underset{(0.04)}{-0.083} \times crim_i + \underset{(0.01)}{0.038} \times age_i.\]</span></p>
<p>Just as in the simple linear regression framework we can conduct hypothesis tests for each coefficient in the multiple regression framework as well. To do so assume that we want to test the null <span class="math inline">\(H_0:\beta_j=0\)</span> against the alternative <span class="math inline">\(H_1:\beta_j\ne 0\)</span> for all <span class="math inline">\(j\)</span>.</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded. The coefficients of the model as well as the corresponding standard errors are already available in <tt>coef</tt> and <tt>se</tt>, respectively.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute t-statistics for each coefficient by using the predefined objects <tt>coef</tt> and <tt>se</tt>. Assign them to <tt>tstat</tt>.</p></li>
<li><p>Compute p values for each coefficient and assign them to <tt>pval</tt>.</p></li>
<li><p>Check with the help of logical operators whether the hypotheses are rejected at a 1% significance level.</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">

<code data-type="pre-exercise-code">
  library(AER)
  library(MASS)
  coef <- summary(lm(medv ~ lstat + crim + age, data = Boston))$coef[, 1]
  se   <- summary(lm(medv ~ lstat + crim + age, data = Boston))$coef[, 2]
</code>
<code data-type="sample-code">
  # Compute t-statistics for each coefficient. Assign them to tstat.
  
  
  # Compute p-values for each coefficient. Assign them to pval.
  
  
  # Check whether the hypotheses are rejected at a 1% significance level.
  
  
</code>
<code data-type="solution">
  # Compute t-statistics for each coefficient. Assign them to tstat.
  tstat <- coef/se
  
  # Compute p values for each coefficient. Assign them to pval.
  pval <- 2*(pnorm(-abs(tstat)))
  
  # Check whether the hypotheses are rejected at a 1% significance level.
  pval < 0.01
  
</code>
<code data-type="sct">
  test_object("tstat")
  test_object("pval")
  test_or(test_output_contains("pval < 0.01"), test_output_contains("pval > 0.01"))
  success_msg("All but the coefficient for the crime rate (crim) can be rejected at a 1% significance level.")
</code>

</div>


<p><strong>Hints:</strong></p>
<ul>
<li><p>The t-statistic for each coefficient is defined as <span class="math inline">\(t=\frac{\widehat{\beta}_j-\beta_{j,0}}{SE(\widehat{\beta}_j)}\)</span>.</p></li>
<li><p>The p value can be computed as <span class="math inline">\(2\Phi(-|t^{act}|)\)</span> where <span class="math inline">\(t^{act}\)</span> denotes the computed t-statistic.</p></li>
</ul>
</div>
<div class="DCexercise">
<h4 id="hypothesis-testing-in-a-multiple-regression-model---confidence-intervals" class="unnumbered">2. Hypothesis Testing in a Multiple Regression Model - Confidence Intervals</h4>
<p>Again consider the model</p>
<p><span class="math display">\[\widehat{medv}_i = \underset{(0.75)}{32.828} \underset{(0.05)}{-0.994} \times lstat_i \underset{(0.04)}{-0.083} \times crim_i + \underset{(0.01)}{0.038} \times age_i.\]</span></p>
<p>which is available as <tt>mod</tt> in your working environment. The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded.</p>
<p><strong>Instruction:</strong></p>
<ul>
<li>Construct a 99% confidence interval for all model coefficients. Decide whether we can reject the null <span class="math inline">\(H_0:\beta_j=0\)</span> for all <span class="math inline">\(j\)</span>.</li>
</ul>


<div data-datacamp-exercise data-lang="r">

<code data-type="pre-exercise-code">
  library(AER)
  library(MASS)
  mod <- lm(medv ~ lstat + crim + age, data = Boston)
</code>
<code data-type="sample-code">
  # Construct a 99% confidence interval for all coefficients
  
  
</code>
<code data-type="solution">
  # Construct a 99% confidence interval for all coefficients
  confint(mod, level = 0.99)
  
</code>
<code data-type="sct">
  test_function("confint", args = c("object", "level"))
  success_msg("Correct! Analogously to the previous exercise we can see that 0 is not an element for all confidence intervals but   for the one of the crime rate. Hence, as expected, the test decision remains the same.")
</code>

</div>


<p><strong>Hint:</strong></p>
<ul>
<li>You can use <tt>confint()</tt> to construct confidence intervals. The confidence level can be set via <tt>level</tt>.</li>
</ul>
</div>
<div class="DCexercise">
<h4 id="hypothesis-testing-in-a-multiple-regression-model---can-we-do-more-robust" class="unnumbered">3. Hypothesis Testing in a Multiple Regression Model - Can we do more robust?</h4>
<p><tt>mod</tt>, the <tt>lm</tt> object with the estimated model</p>
<p><span class="math display">\[\widehat{medv}_i = 32.828 - 0.994 \times lstat_i - 0.083 \times crim_i + 0.038 \times age_i.\]</span></p>
<p>is available in your working environment. The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Print a coefficient summary using heteroscedasticity-robust standard errors.</p></li>
<li><p>Access entries of the matrix created by <tt>coeftest()</tt> to check with the help of logical operators whether the hypotheses are rejected at a 1% significance level.</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">

<code data-type="pre-exercise-code">
  library(AER)
  library(MASS)
  mod <- lm(medv ~ lstat + crim + age, data = Boston)
</code>
<code data-type="sample-code">
  # Print a coefficient summary using robust standard errors.
  
  
  # Check whether the hypotheses are rejected at a 1% significance level.
  
  
</code>
<code data-type="solution">
  # Print a coefficient summary using robust standard errors.
  coeftest(mod, vcov. = vcovHC)
  
  # Check whether the hypotheses are rejected at a 1% significance level.
  coeftest(mod, vcov. = vcovHC)[, 4] < 0.01
  
</code>
<code data-type="sct">
  test_function_result("coeftest")
  test_or(test_output_contains("coeftest(mod, vcov. = vcovHC)[, 4] < 0.01", incorrect_msg = "Not correct! Please make sure you     select the correct entries of the matrix."), test_output_contains("coeftest(mod, vcov. = vcovHC)[, 4] > 0.01", incorrect_msg =   "Not correct! Please make sure you select the correct entries of the matrix."))
  success_msg("Correct! We see that by using robust standard errors the coefficient for the crime rate (crim) becomes              significant, whereas the coefficient for the average age of the buildings (age) becomes insignificant at a 1% significance level.")
</code>

</div>


<p><strong>Hints:</strong></p>
<ul>
<li><p>Inside of <tt>coeftest()</tt> one can set the argument <tt>vcov.</tt> to force the function to use robust standard errors.</p></li>
<li><p>The p values are contained in the fourth column of the matrix. Use square brackets to access them.</p></li>
</ul>
</div>
<div class="DCexercise">
<h4 id="joint-hypothesis-testing---f-test-i" class="unnumbered">4. Joint Hypothesis Testing - F Test I</h4>
<p>Besides testing single hypotheses we can also test joint hypotheses which impose restrictions on multiple regression coefficients. For example in the model</p>
<p><span class="math display">\[medv_i = \beta_0 + \beta_1\times lstat_i + \beta_2\times crim_i + \beta_3\times age_i + u_i\]</span></p>
<p>we could test the null <span class="math inline">\(H_0: \beta_2=\beta_3\)</span> vs. the alternative <span class="math inline">\(H_1: \beta_2\ne\beta_3\)</span> (which in fact is a joint hypothesis as we impose a restriction on two regression coefficients).</p>
<p>The basic idea behind testing such a hypothesis is now to conduct two regressions. For one of the regressions we incorporate the restriction (we call this the restricted model), whereas for the other regression the restriction is left out (we call this the unrestricted model). From this starting point we can then construct a test-statistic which, under the null, follows a well known distribution, namely a <span class="math inline">\(F\)</span> distribution (see next exercise). However in this exercise we start with the initial steps or computations necessary to construct the test-statistic. So please do the following:</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Estimate the restricted model, that is, the model where the restriction is assumed to be true. Save it in <tt>model_res</tt>.</p></li>
<li><p>Compute the SSR of the restricted model and assign it to <tt>RSSR</tt>.</p></li>
<li><p>Estimate the unrestricted model, that is, the model where the restriction is assumed to be false. Save it in <tt>model_unres</tt>.</p></li>
<li><p>Compute the SSR of the unrestricted model and assign it to <tt>USSR</tt>.</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">

<code data-type="pre-exercise-code">
  library(AER)
  library(MASS)
</code>
<code data-type="sample-code">
  # Estimate the restricted model and save it in model_res.
  
  
  # Compute the SSR of the restricted model and assign it to RSSR.
  
  
  # Estimate the unrestricted model and save it in model_unres.
  
  
  # Compute the SSR of the unrestricted model and assign it to USSR.
  
  
</code>
<code data-type="solution">
  # Estimate the restricted model and save it in model_res.
  model_res <- lm(medv ~ lstat + I(crim + age), data = Boston)
  
  # Compute the SSR of the restricted model and assign it to RSSR.
  RSSR <- sum(model_res$residuals^2)
  
  # Estimate the unrestricted model and save it in model_unres.
  model_unres <- lm(medv ~ lstat + crim + age, data = Boston)
  
  # Compute the SSR of the unrestricted model and assign it to USSR.
  USSR <- sum(model_unres$residuals^2)
  
</code>
<code data-type="sct">
  test_or({
  
  test_function("lm", 
               args = c("formula", "data"),
               not_called_msg = "Something is wrong.",
               args_not_specified_msg = "Something is wrong."
               )
               
  
  },{
  
  sol <- ex() %>% override_solution("model_res <- lm(medv ~ lstat + I(crim + age), data = Boston)")
  sol %>% check_function("lm") %>% check_arg("formula") %>% check_equal()
  
  },{
  
  sol <- ex() %>% override_solution("model_res <- lm(Boston$medv ~ Boston$lstat + I(Boston$crim + Boston$age))")
  sol %>% check_function("lm") %>% check_arg("formula") %>% check_equal()
  
  })
  test_object("model_res", eval = F)
  test_object("RSSR")
  test_or({
  
  test_function("lm", 
               args = c("formula", "data"),
               not_called_msg = "Something is wrong.",
               args_not_specified_msg = "Something is wrong."
               )
                
  
  },{
  
  sol <- ex() %>% override_solution("model_unres <- lm(medv ~ lstat + crim + age, data = Boston)")
  sol %>% check_function("lm") %>% check_arg("formula") %>% check_equal()
  
  },{
  
  sol <- ex() %>% override_solution("model_unres <- lm(Boston$medv ~ Boston$lstat + Boston$crim + Boston$age)")
  sol %>% check_function("lm") %>% check_arg("formula") %>% check_equal()
  
  })
  test_object("model_unres", eval = F)
  test_object("USSR")
  success_msg("Correct! Note that the SSR of the restricted model is always greater or equal than the SSR of the unrestricted      model.")
</code>

</div>


<p><strong>Hints:</strong></p>
<ul>
<li><p>The restricted model can be written as <span class="math inline">\(medv_i = \beta_0 + \beta_1\times lstat_i + \beta_2\times crim_i + \beta_2\times age_i + u_i\)</span> which, after rearranging, can be expressed as <span class="math inline">\(medv_i = \beta_0 + \beta_1\times lstat_i + \beta_2\times(crim_i+age_i) + u_i\)</span>.</p></li>
<li><p>The SSR is defined as the sum of the squared residuals.</p></li>
<li><p>Note that the residuals of a regression model are available as <tt>residuals</tt> in the corresponding <tt>lm</tt> object. So you can access them as usual via the <tt>$</tt>-operator.</p></li>
</ul>
</div>
<div class="DCexercise">
<h4 id="joint-hypothesis-testing---f-test-ii" class="unnumbered">5. Joint Hypothesis Testing - F Test II</h4>
<p>After estimating the necessary models and computing the SSR we can now compute the test-statistic and conduct the hypothesis test. As mentioned in the last exercise the test-statistic follows a <span class="math inline">\(F\)</span> distribution or more precisely a <span class="math inline">\(F_{q,n-k-1}\)</span> distribution where <span class="math inline">\(q\)</span> and <span class="math inline">\(k\)</span> denote the number of restrictions under the null and regressors in the unrestricted model, respectively.</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded. Both models (<tt>model_res</tt> and <tt>model_unres</tt>) as well as their SSR (<tt>RSSR</tt> and <tt>USSR</tt>) are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the F-statistic and assign it to <tt>Fstat</tt>.</p></li>
<li><p>Compute the p value and assign it to <tt>pval</tt>.</p></li>
<li><p>Check with the help of logical operators whether the null is rejected at a 1% significance level.</p></li>
<li><p>Verify your result by using <tt>linearHypothesis()</tt> and printing out the results.</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">

<code data-type="pre-exercise-code">
  library(AER)
  library(MASS)
  model_res <- lm(medv ~ lstat + I(crim + age), data = Boston)
  RSSR <- sum(model_res$residuals^2)
  model_unres <- lm(medv ~ lstat + crim + age, data = Boston)
  USSR <- sum(model_unres$residuals^2)
</code>
<code data-type="sample-code">
  # Compute the F-statistic and assign it to Fstat.
  
  
  # Compute the p value and assign it to pval.
  
  
  # Check whether the null is rejected at a 1% significance level.
  
  
  # Verify your result with linearHypothesis().
  
  
</code>
<code data-type="solution">
  # Compute the F-statistic and assign it to Fstat.
  Fstat <- ((RSSR-USSR)/1)/(USSR/(nrow(Boston)-3-1))
  
  # Compute the p value and assign it to pval.
  pval <- 1 - pf(Fstat, df1 = 1, df2 = nrow(Boston)-3-1)
  
  # Check whether the null is rejected at a 1% significance level.
  pval < 0.01
  
  # Verify your result with linearHypothesis().
  linearHypothesis(model_unres, "age = crim")
  
</code>
<code data-type="sct">
  test_object("Fstat")
  test_object("pval")
  test_or(test_output_contains("pval < 0.01"), test_output_contains("pval > 0.01"))
  test_function_result("linearHypothesis")
  success_msg("Correct! The null hypothesis is rejected at a 1% significance level.")
</code>

</div>


<p><strong>Hints:</strong></p>
<ul>
<li><p>The F-statistic is defined as <span class="math inline">\(\frac{RSSR-USSR/q}{USSR/(n-k-1)}\)</span>.</p></li>
<li><p>The p value can be computed as <span class="math inline">\(1-F_{q,n-k-1}(F^{act})\)</span> where <span class="math inline">\(F_{q,n-k-1}\)</span> denotes the CDF of the F distribution (<tt>pf()</tt>) with degrees of freedom <span class="math inline">\(q\)</span> and <span class="math inline">\(n-k-1\)</span> and <span class="math inline">\(F^{act}\)</span> the computed F-statistic.</p></li>
<li><p><tt>linearHypothesis()</tt> expects the unrestricted model as well as the null hypothesis.</p></li>
</ul>
</div>
<div class="DCexercise">
<h4 id="joint-hypothesis-testing---confidence-set" class="unnumbered">6. Joint Hypothesis Testing - Confidence Set</h4>
<p>As you know from previous chapters constructing a confidence set for a single regression coefficient results in a simple confidence interval on the real line. However if we consider <span class="math inline">\(n\)</span> regression coefficients jointly (as we do in a joint hypothesis testing setting) we move from <span class="math inline">\(\mathbb{R}\)</span> to <span class="math inline">\(\mathbb{R}^n\)</span> resulting in a n-dimensional confidence set. For the sake of illustration we then often choose <span class="math inline">\(n=2\)</span>, so that we end up with a representable two-dimensional plane.</p>
<p>Now recall the estimated model</p>
<p><span class="math display">\[\widehat{medv}_i = \underset{(0.75)}{32.828} \underset{(0.05)}{-0.994} \times lstat_i \underset{(0.04)}{-0.083} \times crim_i + \underset{(0.01)}{0.038} \times age_i.\]</span></p>
<p>which is available as <tt>mod</tt> in your working environment and assume we want to test the null <span class="math inline">\(H_0: \beta_2=\beta_3=0\)</span> vs. <span class="math inline">\(H_1: \beta_2\ne 0\)</span> or <span class="math inline">\(\beta_3\ne 0\)</span>.</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Construct a 99% confidence set for the coefficients of <tt>crim</tt> and <tt>lstat</tt>, that is a two-dimensional confidence set. Can you reject the null stated above?</p></li>
<li><p>Verify your visual inspection by conducting a corresponding F test.</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">

<code data-type="pre-exercise-code">
  library(AER)
  library(MASS)
  mod <- lm(medv ~ lstat + crim + age, data = Boston)
</code>
<code data-type="sample-code">
  # Construct a 99% confidence set for the coefficients of crim and lstat.
  
  
  # Conduct a corresponding F test.
  
    
</code>
<code data-type="solution">
  # Construct a 99% confidence set for crim and lstat.
  confidenceEllipse(mod, which.coef = c("crim", "lstat"), levels = 0.99)
  
  # Conduct a corresponding F test.
  linearHypothesis(mod, c("crim = 0", "lstat = 0"))
  
</code>
<code data-type="sct">
  test_or({
    fun <- ex() %>% check_function("confidenceEllipse")
    fun %>% check_arg("model") %>% check_equal()
    fun %>% check_arg("which.coef") %>% check_equal()
    fun %>% check_arg("levels") %>% check_equal()
  }, {
    fun <- ex() %>% override_solution("confidenceEllipse(mod, which.coef = c("lstat", "crim"), levels = 0.99)") %>%                  check_function("confidenceEllipse")
    fun %>% check_arg("model") %>% check_equal()
    fun %>% check_arg("which.coef") %>% check_equal()
    fun %>% check_arg("levels") %>% check_equal()
  })
  test_function_result("linearHypothesis")
  success_msg("Correct! Since (0,0) is not an element of the 99% confidence set, the null hypothesis is rejected at a 1% significance level.")
</code>

</div>


<p><strong>Hints:</strong></p>
<ul>
<li><p>You can use <tt>confidenceEllipse()</tt> to construct a two dimensional confidence set. Besides the coefficients for which the confidence set shall be constructed (<tt>which.coef</tt>), you have to specify the confidence level (<tt>levels</tt>).</p></li>
<li><p>As usual you can use <tt>linearHypothesis()</tt> to conduct a F test. However note that we test two restrictions now, hence you have to pass a vector consisting of both linear restrictions.</p></li>
</ul>
</div>

<div id="refs" class="references">
<div>
<p>Allaire, J., Xie, Y., McPherson, J., Luraschi, J., Ushey, K., Atkins, A., … Chang, W. (2018). <em>Rmarkdown: Dynamic documents for r</em>. Retrieved from <a href="https://CRAN.R-project.org/package=rmarkdown" class="uri">https://CRAN.R-project.org/package=rmarkdown</a></p>
</div>
<div>
<p>Heiss, F. (2016). <em>Using r for introductory econometrics</em>. CreateSpace Independent Publishing Platform.</p>
</div>
<div>
<p>Kleiber, C., &amp; Zeileis, A. (2008). <em>Applied econometrics with r</em>. Springer.</p>
</div>
<div>
<p>R Core Team. (2018). <em>R: A language and environment for statistical computing</em>. Vienna, Austria: R Foundation for Statistical Computing. Retrieved from <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a></p>
</div>
<div>
<p>Stock, J., &amp; Watson, M. (2015). <em>Introduction to econometrics, third update, global edition</em>. Pearson Education Limited.</p>
</div>
<div>
<p>Wooldridge, J. (2016). <em>Introductory econometrics</em> (Sixth). Cengage Learning.</p>
</div>
<div>
<p>Xie, Y. (2018). <em>Knitr: A general-purpose package for dynamic report generation in r</em>. Retrieved from <a href="https://CRAN.R-project.org/package=knitr" class="uri">https://CRAN.R-project.org/package=knitr</a></p>
</div>
</div>
</div>
<!-- </div> -->







            </section>

          </div>
        </div>
      </div>
<a href="analysis-of-the-test-score-data-set.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 1
},
"edit": null,
"download": ["URFITE.pdf"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
