<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Using R for Introduction to Econometrics</title>
  <meta name="description" content="Using <tt>R</tt> for Introduction to Econometrics">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Using R for Introduction to Econometrics" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="Emwikts1970/URFITE-Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Using R for Introduction to Econometrics" />
  
  
  

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber and Martin Schmelzer">


<meta name="date" content="2018-08-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="11-5-apatadlm.html">
<link rel="next" href="11-7-nit.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<!-- datacamp-light-latest -->

<!-- <script async src="https://cdn.datacamp.com/dcl-react.js.gz"></script> -->

<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script> 

<script src="js/hideOutput.js"></script>
<script type="text/javascript" src="MathJax-2.7.2/MathJax.js?config=default"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script async defer src="https://hypothes.is/embed.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">URFITE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-a-very-short-introduction-to-r-and-rstudio.html"><a href="1-1-a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.1</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-htaciitslrm.html"><a href="2-htaciitslrm.html"><i class="fa fa-check"></i><b>2</b> Hypothesis Tests and Confidence Intervals in the Simple Linear Regression Model</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><a href="2-1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><i class="fa fa-check"></i><b>2.1</b> Testing Two-Sided Hypotheses Concerning the Slope Coefficient</a></li>
<li class="chapter" data-level="2.2" data-path="2-2-cifrc.html"><a href="2-2-cifrc.html"><i class="fa fa-check"></i><b>2.2</b> Confidence Intervals for Regression Coefficients</a><ul>
<li class="chapter" data-level="" data-path="2-2-cifrc.html"><a href="2-2-cifrc.html#simulation-study-confidence-intervals"><i class="fa fa-check"></i>Simulation Study: Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-3-rwxiabv.html"><a href="2-3-rwxiabv.html"><i class="fa fa-check"></i><b>2.3</b> Regression when X is a Binary Variable</a></li>
<li class="chapter" data-level="2.4" data-path="2-4-hah.html"><a href="2-4-hah.html"><i class="fa fa-check"></i><b>2.4</b> Heteroskedasticity and Homoskedasticity</a><ul>
<li class="chapter" data-level="" data-path="2-4-hah.html"><a href="2-4-hah.html#a-real-world-example-for-heteroskedasticity"><i class="fa fa-check"></i>A Real-World Example for Heteroskedasticity</a></li>
<li class="chapter" data-level="" data-path="2-4-hah.html"><a href="2-4-hah.html#should-we-care-about-heteroskedasticity"><i class="fa fa-check"></i>Should We Care About Heteroskedasticity?</a></li>
<li class="chapter" data-level="" data-path="2-4-hah.html"><a href="2-4-hah.html#computation-of-heteroskedasticity-robust-standard-errors"><i class="fa fa-check"></i>Computation of Heteroskedasticity-Robust Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-5-the-gauss-markov-theorem.html"><a href="2-5-the-gauss-markov-theorem.html"><i class="fa fa-check"></i><b>2.5</b> The Gauss-Markov Theorem</a><ul>
<li class="chapter" data-level="" data-path="2-5-the-gauss-markov-theorem.html"><a href="2-5-the-gauss-markov-theorem.html#simulation-study-blue-estimator"><i class="fa fa-check"></i>Simulation Study: BLUE Estimator</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><a href="2-6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><i class="fa fa-check"></i><b>2.6</b> Using the t-Statistic in Regression When the Sample Size Is Small</a></li>
<li class="chapter" data-level="2.7" data-path="2-7-exercises.html"><a href="2-7-exercises.html"><i class="fa fa-check"></i><b>2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-rmwmr.html"><a href="3-rmwmr.html"><i class="fa fa-check"></i><b>3</b> Regression Models with Multiple Regressors</a><ul>
<li class="chapter" data-level="3.1" data-path="3-1-omitted-variable-bias.html"><a href="3-1-omitted-variable-bias.html"><i class="fa fa-check"></i><b>3.1</b> Omitted Variable Bias</a></li>
<li class="chapter" data-level="3.2" data-path="3-2-tmrm.html"><a href="3-2-tmrm.html"><i class="fa fa-check"></i><b>3.2</b> The Multiple Regression Model</a></li>
<li class="chapter" data-level="3.3" data-path="3-3-mofimr.html"><a href="3-3-mofimr.html"><i class="fa fa-check"></i><b>3.3</b> Measures of Fit in Multiple Regression</a></li>
<li class="chapter" data-level="3.4" data-path="3-4-ols-assumptions-in-multiple-regression.html"><a href="3-4-ols-assumptions-in-multiple-regression.html"><i class="fa fa-check"></i><b>3.4</b> OLS Assumptions in Multiple Regression</a><ul>
<li class="chapter" data-level="" data-path="3-4-ols-assumptions-in-multiple-regression.html"><a href="3-4-ols-assumptions-in-multiple-regression.html#multicollinearity"><i class="fa fa-check"></i>Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="3-4-ols-assumptions-in-multiple-regression.html"><a href="3-4-ols-assumptions-in-multiple-regression.html#simulation-study-imperfect-multicollinearity"><i class="fa fa-check"></i>Simulation Study: Imperfect Multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-5-the-distribution-of-the-ols-estimators-in-multiple-regression.html"><a href="3-5-the-distribution-of-the-ols-estimators-in-multiple-regression.html"><i class="fa fa-check"></i><b>3.5</b> The Distribution of the OLS Estimators in Multiple Regression</a></li>
<li class="chapter" data-level="3.6" data-path="3-6-exercises-1.html"><a href="3-6-exercises-1.html"><i class="fa fa-check"></i><b>3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-htaciimr.html"><a href="4-htaciimr.html"><i class="fa fa-check"></i><b>4</b> Hypothesis Tests and Confidence Intervals in Multiple Regression</a><ul>
<li class="chapter" data-level="4.1" data-path="4-1-hypothesis-tests-and-confidence-intervals-for-a-single-coefficient.html"><a href="4-1-hypothesis-tests-and-confidence-intervals-for-a-single-coefficient.html"><i class="fa fa-check"></i><b>4.1</b> Hypothesis Tests and Confidence Intervals for a Single Coefficient</a></li>
<li class="chapter" data-level="4.2" data-path="4-2-an-application-to-test-scores-and-the-student-teacher-ratio.html"><a href="4-2-an-application-to-test-scores-and-the-student-teacher-ratio.html"><i class="fa fa-check"></i><b>4.2</b> An Application to Test Scores and the Student-Teacher Ratio</a><ul>
<li class="chapter" data-level="" data-path="4-2-an-application-to-test-scores-and-the-student-teacher-ratio.html"><a href="4-2-an-application-to-test-scores-and-the-student-teacher-ratio.html#another-augmentation-of-the-model"><i class="fa fa-check"></i>Another Augmentation of the Model</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-3-joint-hypothesis-testing-using-the-f-statistic.html"><a href="4-3-joint-hypothesis-testing-using-the-f-statistic.html"><i class="fa fa-check"></i><b>4.3</b> Joint Hypothesis Testing Using the F-Statistic</a></li>
<li class="chapter" data-level="4.4" data-path="4-4-confidence-sets-for-multiple-coefficients.html"><a href="4-4-confidence-sets-for-multiple-coefficients.html"><i class="fa fa-check"></i><b>4.4</b> Confidence Sets for Multiple Coefficients</a></li>
<li class="chapter" data-level="4.5" data-path="4-5-model-specification-for-multiple-regression.html"><a href="4-5-model-specification-for-multiple-regression.html"><i class="fa fa-check"></i><b>4.5</b> Model Specification for Multiple Regression</a><ul>
<li class="chapter" data-level="" data-path="4-5-model-specification-for-multiple-regression.html"><a href="4-5-model-specification-for-multiple-regression.html#model-specification-in-theory-and-in-practice"><i class="fa fa-check"></i>Model Specification in Theory and in Practice</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4-6-analysis-of-the-test-score-data-set.html"><a href="4-6-analysis-of-the-test-score-data-set.html"><i class="fa fa-check"></i><b>4.6</b> Analysis of the Test Score Data Set</a></li>
<li class="chapter" data-level="4.7" data-path="4-7-exercises-2.html"><a href="4-7-exercises-2.html"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-nrf.html"><a href="5-nrf.html"><i class="fa fa-check"></i><b>5</b> Nonlinear Regression Functions</a><ul>
<li class="chapter" data-level="5.1" data-path="5-1-a-general-strategy-for-modelling-nonlinear-regression-functions.html"><a href="5-1-a-general-strategy-for-modelling-nonlinear-regression-functions.html"><i class="fa fa-check"></i><b>5.1</b> A General Strategy for Modelling Nonlinear Regression Functions</a></li>
<li class="chapter" data-level="5.2" data-path="5-2-nfoasiv.html"><a href="5-2-nfoasiv.html"><i class="fa fa-check"></i><b>5.2</b> Nonlinear Functions of a Single Independent Variable</a><ul>
<li class="chapter" data-level="" data-path="5-2-nfoasiv.html"><a href="5-2-nfoasiv.html#polynomials"><i class="fa fa-check"></i>Polynomials</a></li>
<li class="chapter" data-level="" data-path="5-2-nfoasiv.html"><a href="5-2-nfoasiv.html#logarithms"><i class="fa fa-check"></i>Logarithms</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-3-interactions-between-independent-variables.html"><a href="5-3-interactions-between-independent-variables.html"><i class="fa fa-check"></i><b>5.3</b> Interactions Between Independent Variables</a></li>
<li class="chapter" data-level="5.4" data-path="5-4-nonlinear-effects-on-test-scores-of-the-student-teacher-ratio.html"><a href="5-4-nonlinear-effects-on-test-scores-of-the-student-teacher-ratio.html"><i class="fa fa-check"></i><b>5.4</b> Nonlinear Effects on Test Scores of the Student-Teacher Ratio</a></li>
<li class="chapter" data-level="5.5" data-path="5-5-exercises-3.html"><a href="5-5-exercises-3.html"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-asbomr.html"><a href="6-asbomr.html"><i class="fa fa-check"></i><b>6</b> Assessing Studies Based on Multiple Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="6-1-internal-and-external-validity.html"><a href="6-1-internal-and-external-validity.html"><i class="fa fa-check"></i><b>6.1</b> Internal and External Validity</a></li>
<li class="chapter" data-level="6.2" data-path="6-2-ttivomra.html"><a href="6-2-ttivomra.html"><i class="fa fa-check"></i><b>6.2</b> Threats to Internal Validity of Multiple Regression Analysis</a></li>
<li class="chapter" data-level="6.3" data-path="6-3-internal-and-external-validity-when-the-regression-is-used-for-forecasting.html"><a href="6-3-internal-and-external-validity-when-the-regression-is-used-for-forecasting.html"><i class="fa fa-check"></i><b>6.3</b> Internal and External Validity when the Regression is Used for Forecasting</a></li>
<li class="chapter" data-level="6.4" data-path="6-4-etsacs.html"><a href="6-4-etsacs.html"><i class="fa fa-check"></i><b>6.4</b> Example: Test Scores and Class Size</a></li>
<li class="chapter" data-level="6.5" data-path="6-5-exercises-4.html"><a href="6-5-exercises-4.html"><i class="fa fa-check"></i><b>6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-rwpd.html"><a href="7-rwpd.html"><i class="fa fa-check"></i><b>7</b> Regression with Panel Data</a><ul>
<li class="chapter" data-level="7.1" data-path="7-1-panel-data.html"><a href="7-1-panel-data.html"><i class="fa fa-check"></i><b>7.1</b> Panel Data</a></li>
<li class="chapter" data-level="7.2" data-path="7-2-PDWTTP.html"><a href="7-2-PDWTTP.html"><i class="fa fa-check"></i><b>7.2</b> Panel Data with Two Time Periods: “Before and After” Comparisons</a></li>
<li class="chapter" data-level="7.3" data-path="7-3-fixed-effects-regression.html"><a href="7-3-fixed-effects-regression.html"><i class="fa fa-check"></i><b>7.3</b> Fixed Effects Regression</a><ul>
<li class="chapter" data-level="" data-path="7-3-fixed-effects-regression.html"><a href="7-3-fixed-effects-regression.html#estimation-and-inference"><i class="fa fa-check"></i>Estimation and Inference</a></li>
<li class="chapter" data-level="" data-path="7-3-fixed-effects-regression.html"><a href="7-3-fixed-effects-regression.html#application-to-traffic-deaths"><i class="fa fa-check"></i>Application to Traffic Deaths</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7-4-regression-with-time-fixed-effects.html"><a href="7-4-regression-with-time-fixed-effects.html"><i class="fa fa-check"></i><b>7.4</b> Regression with Time Fixed Effects</a></li>
<li class="chapter" data-level="7.5" data-path="7-5-tferaaseffer.html"><a href="7-5-tferaaseffer.html"><i class="fa fa-check"></i><b>7.5</b> The Fixed Effects Regression Assumptions and Standard Errors for Fixed Effects Regression</a></li>
<li class="chapter" data-level="7.6" data-path="7-6-drunk-driving-laws-and-traffic-deaths.html"><a href="7-6-drunk-driving-laws-and-traffic-deaths.html"><i class="fa fa-check"></i><b>7.6</b> Drunk Driving Laws and Traffic Deaths</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-rwabdv.html"><a href="8-rwabdv.html"><i class="fa fa-check"></i><b>8</b> Regression with a Binary Dependent Variable</a><ul>
<li class="chapter" data-level="8.1" data-path="8-1-binary-dependent-variables-and-the-linear-probability-model.html"><a href="8-1-binary-dependent-variables-and-the-linear-probability-model.html"><i class="fa fa-check"></i><b>8.1</b> Binary Dependent Variables and the Linear Probability Model</a></li>
<li class="chapter" data-level="8.2" data-path="8-2-probit-and-logit-regression.html"><a href="8-2-probit-and-logit-regression.html"><i class="fa fa-check"></i><b>8.2</b> Probit and Logit Regression</a><ul>
<li class="chapter" data-level="" data-path="8-2-probit-and-logit-regression.html"><a href="8-2-probit-and-logit-regression.html#probit-regression"><i class="fa fa-check"></i>Probit Regression</a></li>
<li class="chapter" data-level="" data-path="8-2-probit-and-logit-regression.html"><a href="8-2-probit-and-logit-regression.html#logit-regression"><i class="fa fa-check"></i>Logit Regression</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-3-estimation-and-inference-in-the-logit-and-probit-models.html"><a href="8-3-estimation-and-inference-in-the-logit-and-probit-models.html"><i class="fa fa-check"></i><b>8.3</b> Estimation and Inference in the Logit and Probit Models</a></li>
<li class="chapter" data-level="8.4" data-path="8-4-application-to-the-boston-hmda-data.html"><a href="8-4-application-to-the-boston-hmda-data.html"><i class="fa fa-check"></i><b>8.4</b> Application to the Boston HMDA Data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-ivr.html"><a href="9-ivr.html"><i class="fa fa-check"></i><b>9</b> Instrumental Variables Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="9-1-TIVEWASRAASI.html"><a href="9-1-TIVEWASRAASI.html"><i class="fa fa-check"></i><b>9.1</b> The IV Estimator with a Single Regressor and a Single Instrument</a></li>
<li class="chapter" data-level="9.2" data-path="9-2-TGIVRM.html"><a href="9-2-TGIVRM.html"><i class="fa fa-check"></i><b>9.2</b> The General IV Regression Model</a></li>
<li class="chapter" data-level="9.3" data-path="9-3-civ.html"><a href="9-3-civ.html"><i class="fa fa-check"></i><b>9.3</b> Checking Instrument Validity</a></li>
<li class="chapter" data-level="9.4" data-path="9-4-attdfc.html"><a href="9-4-attdfc.html"><i class="fa fa-check"></i><b>9.4</b> Application to the Demand for Cigarettes</a></li>
<li class="chapter" data-level="9.5" data-path="9-5-where-do-valid-instruments-come-from.html"><a href="9-5-where-do-valid-instruments-come-from.html"><i class="fa fa-check"></i><b>9.5</b> Where Do Valid Instruments Come From?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-eaqe.html"><a href="10-eaqe.html"><i class="fa fa-check"></i><b>10</b> Experiments and Quasi-Experiments</a><ul>
<li class="chapter" data-level="10.1" data-path="10-1-potential-outcomes-causal-effects-and-idealized-experiments.html"><a href="10-1-potential-outcomes-causal-effects-and-idealized-experiments.html"><i class="fa fa-check"></i><b>10.1</b> Potential Outcomes, Causal Effects and Idealized Experiments</a></li>
<li class="chapter" data-level="10.2" data-path="10-2-threats-to-validity-of-experiments.html"><a href="10-2-threats-to-validity-of-experiments.html"><i class="fa fa-check"></i><b>10.2</b> Threats to Validity of Experiments</a></li>
<li class="chapter" data-level="10.3" data-path="10-3-experimental-estimates-of-the-effect-of-class-size-reductions.html"><a href="10-3-experimental-estimates-of-the-effect-of-class-size-reductions.html"><i class="fa fa-check"></i><b>10.3</b> Experimental Estimates of the Effect of Class Size Reductions</a><ul>
<li class="chapter" data-level="" data-path="10-3-experimental-estimates-of-the-effect-of-class-size-reductions.html"><a href="10-3-experimental-estimates-of-the-effect-of-class-size-reductions.html#experimental-design-and-the-data-set"><i class="fa fa-check"></i>Experimental Design and the Data Set</a></li>
<li class="chapter" data-level="" data-path="10-3-experimental-estimates-of-the-effect-of-class-size-reductions.html"><a href="10-3-experimental-estimates-of-the-effect-of-class-size-reductions.html#analysis-of-the-star-data"><i class="fa fa-check"></i>Analysis of the STAR Data</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10-4-quasi-experiments.html"><a href="10-4-quasi-experiments.html"><i class="fa fa-check"></i><b>10.4</b> Quasi Experiments</a><ul>
<li class="chapter" data-level="" data-path="10-4-quasi-experiments.html"><a href="10-4-quasi-experiments.html#the-differences-in-differences-estimator"><i class="fa fa-check"></i>The Differences-in-Differences Estimator</a></li>
<li class="chapter" data-level="" data-path="10-4-quasi-experiments.html"><a href="10-4-quasi-experiments.html#regression-discontinuity-estimators"><i class="fa fa-check"></i>Regression Discontinuity Estimators</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-ittsraf.html"><a href="11-ittsraf.html"><i class="fa fa-check"></i><b>11</b> Introduction to Time Series Regression and Forecasting</a><ul>
<li class="chapter" data-level="11.1" data-path="11-1-using-regression-models-for-forecasting.html"><a href="11-1-using-regression-models-for-forecasting.html"><i class="fa fa-check"></i><b>11.1</b> Using Regression Models for Forecasting</a></li>
<li class="chapter" data-level="11.2" data-path="11-2-tsdasc.html"><a href="11-2-tsdasc.html"><i class="fa fa-check"></i><b>11.2</b> Time Series Data and Serial Correlation</a><ul>
<li class="chapter" data-level="" data-path="11-2-tsdasc.html"><a href="11-2-tsdasc.html#notation-lags-differences-logarithms-and-growth-rates"><i class="fa fa-check"></i>Notation, Lags, Differences, Logarithms and Growth Rates</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="11-3-autoregressions.html"><a href="11-3-autoregressions.html"><i class="fa fa-check"></i><b>11.3</b> Autoregressions</a><ul>
<li><a href="11-3-autoregressions.html#autoregressive-models-of-order-p">Autoregressive Models of Order <span class="math inline">\(p\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="11-4-cybtmpi.html"><a href="11-4-cybtmpi.html"><i class="fa fa-check"></i><b>11.4</b> Can You Beat the Market? (Part I)</a></li>
<li class="chapter" data-level="11.5" data-path="11-5-apatadlm.html"><a href="11-5-apatadlm.html"><i class="fa fa-check"></i><b>11.5</b> Additional Predictors and The ADL Model</a><ul>
<li class="chapter" data-level="" data-path="11-5-apatadlm.html"><a href="11-5-apatadlm.html#forecast-uncertainty-and-forecast-intervals"><i class="fa fa-check"></i>Forecast Uncertainty and Forecast Intervals</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="11-6-llsuic.html"><a href="11-6-llsuic.html"><i class="fa fa-check"></i><b>11.6</b> Lag Length Selection Using Information Criteria</a></li>
<li class="chapter" data-level="11.7" data-path="11-7-nit.html"><a href="11-7-nit.html"><i class="fa fa-check"></i><b>11.7</b> Nonstationarity I: Trends</a></li>
<li class="chapter" data-level="11.8" data-path="11-8-niib.html"><a href="11-8-niib.html"><i class="fa fa-check"></i><b>11.8</b> Nonstationarity II: Breaks</a></li>
<li class="chapter" data-level="11.9" data-path="11-9-can-you-beat-the-market-part-ii.html"><a href="11-9-can-you-beat-the-market-part-ii.html"><i class="fa fa-check"></i><b>11.9</b> Can You Beat the Market? (Part II)</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-eodce.html"><a href="12-eodce.html"><i class="fa fa-check"></i><b>12</b> Estimation of Dynamic Causal Effects</a><ul>
<li class="chapter" data-level="12.1" data-path="12-1-the-orange-juice-data.html"><a href="12-1-the-orange-juice-data.html"><i class="fa fa-check"></i><b>12.1</b> The Orange Juice Data</a></li>
<li class="chapter" data-level="12.2" data-path="12-2-dynamic-causal-effects.html"><a href="12-2-dynamic-causal-effects.html"><i class="fa fa-check"></i><b>12.2</b> Dynamic Causal Effects</a></li>
<li class="chapter" data-level="12.3" data-path="12-3-dynamic-multipliers-and-cumulative-dynamic-multipliers.html"><a href="12-3-dynamic-multipliers-and-cumulative-dynamic-multipliers.html"><i class="fa fa-check"></i><b>12.3</b> Dynamic Multipliers and Cumulative Dynamic Multipliers</a></li>
<li class="chapter" data-level="12.4" data-path="12-4-hac-standard-errors.html"><a href="12-4-hac-standard-errors.html"><i class="fa fa-check"></i><b>12.4</b> HAC Standard Errors</a></li>
<li class="chapter" data-level="12.5" data-path="12-5-estimation-of-dynamic-causal-effects-with-strictly-exogeneous-regressors.html"><a href="12-5-estimation-of-dynamic-causal-effects-with-strictly-exogeneous-regressors.html"><i class="fa fa-check"></i><b>12.5</b> Estimation of Dynamic Causal Effects with Strictly Exogeneous Regressors</a></li>
<li class="chapter" data-level="12.6" data-path="12-6-orange-juice-prices-and-cold-weather.html"><a href="12-6-orange-juice-prices-and-cold-weather.html"><i class="fa fa-check"></i><b>12.6</b> Orange Juice Prices and Cold Weather</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-atitsr.html"><a href="13-atitsr.html"><i class="fa fa-check"></i><b>13</b> Additional Topics in Time Series Regression</a><ul>
<li class="chapter" data-level="13.1" data-path="13-1-vector-autoregressions.html"><a href="13-1-vector-autoregressions.html"><i class="fa fa-check"></i><b>13.1</b> Vector Autoregressions</a></li>
<li class="chapter" data-level="13.2" data-path="13-2-ooiatdfglsurt.html"><a href="13-2-ooiatdfglsurt.html"><i class="fa fa-check"></i><b>13.2</b> Orders of Integration and the DF-GLS Unit Root Test</a></li>
<li class="chapter" data-level="13.3" data-path="13-3-cointegration.html"><a href="13-3-cointegration.html"><i class="fa fa-check"></i><b>13.3</b> Cointegration</a></li>
<li class="chapter" data-level="13.4" data-path="13-4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="13-4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><i class="fa fa-check"></i><b>13.4</b> Volatility Clustering and Autoregressive Conditional Heteroskedasticity</a><ul>
<li class="chapter" data-level="" data-path="13-4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="13-4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html#arch-and-garch-models"><i class="fa fa-check"></i>ARCH and GARCH Models</a></li>
<li class="chapter" data-level="" data-path="13-4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="13-4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html#application-to-stock-price-volatility"><i class="fa fa-check"></i>Application to Stock Price Volatility</a></li>
<li class="chapter" data-level="" data-path="13-4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="13-4-volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html#summary-8"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using <tt>R</tt> for Introduction to Econometrics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. You can also see the annotations of others: click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="llsuic" class="section level2">
<h2><span class="header-section-number">11.6</span> Lag Length Selection Using Information Criteria</h2>
<p>The selection of lag lengths in AR and ADL models can sometimes be guided by economic theory. However, there are statistical methods that are helpful to determine how many lags should be included as regressors. In general, too many lags inflate the standard errors of coefficient estimates and thus imply an increase in the forecast error while omitting lags that should be included in the model may result in an estimation bias.</p>
<p>The order of an AR model can be determined using two approaches:</p>
<ol style="list-style-type: decimal">
<li><p><strong>The F-test approach</strong></p>
<p>Estimate an AR(<span class="math inline">\(p\)</span>) model and test the significance of the largest lag(s). If the test rejects, drop the respective lag(s) from the model. This approach has the tendency to produce models where the order is too large: in a significance test we always face the risk of rejecting a true null hypothesis!</p></li>
<li><p><strong>Relying on an information criterion</strong></p>
<p>To circumvent the issue of producing too large models, one may choose the lag order that minimizes one of the following two information criteria:</p>
<ul>
<li><p>The <em>Bayes information criterion</em> (BIC):</p>
<p><span class="math display">\[BIC(p) = \log\left(\frac{SSR(p)}{T}\right) + (p + 1) \frac{\log(T)}{T}\]</span></p></li>
<li><p>The <em>Akaike information criterion</em> (AIC):</p>
<p><span class="math display">\[AIC(p) = \log\left(\frac{SSR(p)}{T}\right) + (p + 1) \frac{2}{T}\]</span></p></li>
</ul>
<p>Both criteria are estimators of the optimal lag length <span class="math inline">\(p\)</span>. The lag order <span class="math inline">\(\widehat{p}\)</span> that minimizes the respective criterion is called the <em>BIC estimate</em> or the <em>AIC estimate</em> of the optimal model order. The basic idea of both criteria is that the <span class="math inline">\(SSR\)</span> decreases as additional lags are added to the model such that the first term decreases whereas the second increases as the lag order grows. One can show that the the <span class="math inline">\(BIC\)</span> is a consistent estimator of the true lag order while the AIC is not which is due to the differing factors in the second addend. Nevertheless, both estimators are used in practice where the <span class="math inline">\(AIC\)</span> is sometimes used as an alternative when the <span class="math inline">\(BIC\)</span> yields a model with “too few” lags.</p></li>
</ol>
<p>The function <tt>dynlm()</tt> does not compute information criteria by default. We will therefore write a short function that reports the <span class="math inline">\(BIC\)</span> (along with the chosen lag order <span class="math inline">\(p\)</span> and <span class="math inline">\(R^2\)</span>) for objects of class <tt>dynlm</tt>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compute BIC for AR model objects of class &#39;dynlm&#39;</span>
BIC &lt;-<span class="st"> </span><span class="cf">function</span>(model) {
  
  ssr &lt;-<span class="st"> </span><span class="kw">sum</span>(model<span class="op">$</span>residuals<span class="op">^</span><span class="dv">2</span>)
  t &lt;-<span class="st"> </span><span class="kw">length</span>(model<span class="op">$</span>residuals)
  npar &lt;-<span class="st"> </span><span class="kw">length</span>(model<span class="op">$</span>coef)
  
  <span class="kw">return</span>(
    <span class="kw">round</span>(<span class="kw">c</span>(<span class="st">&quot;p&quot;</span> =<span class="st"> </span>npar <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,
          <span class="st">&quot;BIC&quot;</span> =<span class="st"> </span><span class="kw">log</span>(ssr<span class="op">/</span>t) <span class="op">+</span><span class="st"> </span>npar <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(t)<span class="op">/</span>t,
          <span class="st">&quot;R2&quot;</span> =<span class="st"> </span><span class="kw">summary</span>(model)<span class="op">$</span>r.squared), <span class="dv">4</span>)
  )
}</code></pre></div>
<p>Table 14.3 of the book presents a breakdown of how the <span class="math inline">\(BIC\)</span> is computed for AR(<span class="math inline">\(p\)</span>) models of GDP growth with order <span class="math inline">\(p=1,\dots,6\)</span>. The final result can easily be reproduced using <tt>sapply()</tt> and the function <tt>BIC()</tt> defined above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># apply the BIC() to an intercept-only model of GDP growth</span>
<span class="kw">BIC</span>(<span class="kw">dynlm</span>(<span class="kw">ts</span>(GDPGR_level) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>))</code></pre></div>
<pre><code>##      p    BIC     R2 
## 0.0000 2.4394 0.0000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># loop BIC over models of different orders</span>
order &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">6</span>

BICs &lt;-<span class="st"> </span><span class="kw">sapply</span>(order, <span class="cf">function</span>(x) 
        <span class="st">&quot;AR&quot;</span> =<span class="st"> </span><span class="kw">BIC</span>(<span class="kw">dynlm</span>(<span class="kw">ts</span>(GDPGR_level) <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(<span class="kw">ts</span>(GDPGR_level), <span class="dv">1</span><span class="op">:</span>x))))

BICs</code></pre></div>
<pre><code>##       [,1]   [,2]   [,3]   [,4]   [,5]   [,6]
## p   1.0000 2.0000 3.0000 4.0000 5.0000 6.0000
## BIC 2.3486 2.3475 2.3774 2.4034 2.4188 2.4429
## R2  0.1143 0.1425 0.1434 0.1478 0.1604 0.1591</code></pre>
<p>Note that increasing the lag order increases <span class="math inline">\(R^2\)</span> because the <span class="math inline">\(SSR\)</span> decreases as additional lags are added to the model but according to the <span class="math inline">\(BIC\)</span>, we should settle for the AR(<span class="math inline">\(2\)</span>) model instead of the AR(<span class="math inline">\(6\)</span>) model. It helps us to decide whether the decrease in <span class="math inline">\(SSR\)</span> is enough to justify adding an additional regressor.</p>
<p>If we had to compare a bigger set of models, a convenient way to select the model with the lowest <span class="math inline">\(BIC\)</span> is using the function <tt>which.min()</tt>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># select the AR model with the smallest BIC</span>
BICs[, <span class="kw">which.min</span>(BICs[<span class="dv">2</span>, ])]</code></pre></div>
<pre><code>##      p    BIC     R2 
## 2.0000 2.3475 0.1425</code></pre>
The <span class="math inline">\(BIC\)</span> may also be used to select lag lengths in time series regression models with multiple predictors. In a model with <span class="math inline">\(K\)</span> coefficients, including the intercept, we have
<span class="math display">\[\begin{align*}
    BIC(K) = \log\left(\frac{SSR(K)}{T}\right) + K \frac{\log(T)}{T}.
\end{align*}\]</span>
<p>Notice that choosing the optimal model according to the <span class="math inline">\(BIC\)</span> can be computationally demanding because there may be many different combinations of lag lengths when there are multiple predictors.</p>
<p>To give an example, we estimate ADL(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) models of GDP growth where, as above, the additional variable is the term spread between short-term and long-term bonds. We impose the restriction that <span class="math inline">\(p=q_1=\dots=q_k\)</span> so that only <span class="math inline">\(p_{max}\)</span> models (<span class="math inline">\(p=1,\dots,p_{max}\)</span>) need to be estimated. In the example below we choose <span class="math inline">\(p_{max} = 12\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># loop &#39;BIC()&#39; over multiple ADL models </span>
order &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>

BICs &lt;-<span class="st"> </span><span class="kw">sapply</span>(order, <span class="cf">function</span>(x) 
         <span class="kw">BIC</span>(<span class="kw">dynlm</span>(GDPGrowth_ts <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(GDPGrowth_ts, <span class="dv">1</span><span class="op">:</span>x) <span class="op">+</span><span class="st"> </span><span class="kw">L</span>(TSpread_ts, <span class="dv">1</span><span class="op">:</span>x), 
                   <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))))

BICs</code></pre></div>
<pre><code>##       [,1]   [,2]   [,3]   [,4]    [,5]    [,6]    [,7]    [,8]    [,9]
## p   2.0000 4.0000 6.0000 8.0000 10.0000 12.0000 14.0000 16.0000 18.0000
## BIC 2.3411 2.3408 2.3813 2.4181  2.4568  2.5048  2.5539  2.6029  2.6182
## R2  0.1417 0.1855 0.1950 0.2072  0.2178  0.2211  0.2234  0.2253  0.2581
##       [,10]   [,11]   [,12]
## p   20.0000 22.0000 24.0000
## BIC  2.6646  2.7205  2.7664
## R2   0.2678  0.2702  0.2803</code></pre>
<p>From the definition of <tt>BIC()</tt>, for ADL models with <span class="math inline">\(p=q\)</span> it follows that <tt>p</tt> reports the number of estimated coefficients <em>excluding</em> the intercept. Thus the lag order is obtained by dividing <tt>p</tt> by 2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># select the ADL model with the smallest BIC</span>
BICs[, <span class="kw">which.min</span>(BICs[<span class="dv">2</span>, ])]</code></pre></div>
<pre><code>##      p    BIC     R2 
## 4.0000 2.3408 0.1855</code></pre>
<p>The <span class="math inline">\(BIC\)</span> is in favor of the ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) model <a href="11-5-apatadlm.html#eq:gdpgradl22">(11.5)</a> we have estimated before.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="11-5-apatadlm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="11-7-nit.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 1
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
