<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Using R for Introduction to Econometrics</title>
  <meta name="description" content="Using <tt>R</tt> for Introduction to Econometrics">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Using R for Introduction to Econometrics" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="Emwikts1970/URFITE-Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Using R for Introduction to Econometrics" />
  
  
  

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber and Martin Schmelzer">


<meta name="date" content="2018-08-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="4-4-nonlinear-effects-on-test-scores-of-the-student-teacher-ratio.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<!-- datacamp-light-latest -->

<!-- <script async src="https://cdn.datacamp.com/dcl-react.js.gz"></script> -->

<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script> 

<script src="js/hideOutput.js"></script>
<script type="text/javascript" src="MathJax-2.7.2/MathJax.js?config=default"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script async defer src="https://hypothes.is/embed.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">URFITE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-a-very-short-introduction-to-r-and-rstudio.html"><a href="1-1-a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.1</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-htaciitslrm.html"><a href="2-htaciitslrm.html"><i class="fa fa-check"></i><b>2</b> Hypothesis Tests and Confidence Intervals in the Simple Linear Regression Model</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><a href="2-1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><i class="fa fa-check"></i><b>2.1</b> Testing Two-Sided Hypotheses Concerning the Slope Coefficient</a></li>
<li class="chapter" data-level="2.2" data-path="2-2-cifrc.html"><a href="2-2-cifrc.html"><i class="fa fa-check"></i><b>2.2</b> Confidence Intervals for Regression Coefficients</a><ul>
<li class="chapter" data-level="" data-path="2-2-cifrc.html"><a href="2-2-cifrc.html#simulation-study-confidence-intervals"><i class="fa fa-check"></i>Simulation Study: Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-3-rwxiabv.html"><a href="2-3-rwxiabv.html"><i class="fa fa-check"></i><b>2.3</b> Regression when X is a Binary Variable</a></li>
<li class="chapter" data-level="2.4" data-path="2-4-hah.html"><a href="2-4-hah.html"><i class="fa fa-check"></i><b>2.4</b> Heteroskedasticity and Homoskedasticity</a><ul>
<li class="chapter" data-level="" data-path="2-4-hah.html"><a href="2-4-hah.html#a-real-world-example-for-heteroskedasticity"><i class="fa fa-check"></i>A Real-World Example for Heteroskedasticity</a></li>
<li class="chapter" data-level="" data-path="2-4-hah.html"><a href="2-4-hah.html#should-we-care-about-heteroskedasticity"><i class="fa fa-check"></i>Should We Care About Heteroskedasticity?</a></li>
<li class="chapter" data-level="" data-path="2-4-hah.html"><a href="2-4-hah.html#computation-of-heteroskedasticity-robust-standard-errors"><i class="fa fa-check"></i>Computation of Heteroskedasticity-Robust Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-5-the-gauss-markov-theorem.html"><a href="2-5-the-gauss-markov-theorem.html"><i class="fa fa-check"></i><b>2.5</b> The Gauss-Markov Theorem</a><ul>
<li class="chapter" data-level="" data-path="2-5-the-gauss-markov-theorem.html"><a href="2-5-the-gauss-markov-theorem.html#simulation-study-blue-estimator"><i class="fa fa-check"></i>Simulation Study: BLUE Estimator</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><a href="2-6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><i class="fa fa-check"></i><b>2.6</b> Using the t-Statistic in Regression When the Sample Size Is Small</a></li>
<li class="chapter" data-level="2.7" data-path="2-7-exercises.html"><a href="2-7-exercises.html"><i class="fa fa-check"></i><b>2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-rmwmr.html"><a href="3-rmwmr.html"><i class="fa fa-check"></i><b>3</b> Regression Models with Multiple Regressors</a><ul>
<li class="chapter" data-level="3.1" data-path="3-1-omitted-variable-bias.html"><a href="3-1-omitted-variable-bias.html"><i class="fa fa-check"></i><b>3.1</b> Omitted Variable Bias</a></li>
<li class="chapter" data-level="3.2" data-path="3-2-tmrm.html"><a href="3-2-tmrm.html"><i class="fa fa-check"></i><b>3.2</b> The Multiple Regression Model</a></li>
<li class="chapter" data-level="3.3" data-path="3-3-mofimr.html"><a href="3-3-mofimr.html"><i class="fa fa-check"></i><b>3.3</b> Measures of Fit in Multiple Regression</a></li>
<li class="chapter" data-level="3.4" data-path="3-4-ols-assumptions-in-multiple-regression.html"><a href="3-4-ols-assumptions-in-multiple-regression.html"><i class="fa fa-check"></i><b>3.4</b> OLS Assumptions in Multiple Regression</a><ul>
<li class="chapter" data-level="" data-path="3-4-ols-assumptions-in-multiple-regression.html"><a href="3-4-ols-assumptions-in-multiple-regression.html#multicollinearity"><i class="fa fa-check"></i>Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="3-4-ols-assumptions-in-multiple-regression.html"><a href="3-4-ols-assumptions-in-multiple-regression.html#simulation-study-imperfect-multicollinearity"><i class="fa fa-check"></i>Simulation Study: Imperfect Multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-5-the-distribution-of-the-ols-estimators-in-multiple-regression.html"><a href="3-5-the-distribution-of-the-ols-estimators-in-multiple-regression.html"><i class="fa fa-check"></i><b>3.5</b> The Distribution of the OLS Estimators in Multiple Regression</a></li>
<li class="chapter" data-level="3.6" data-path="3-6-exercises-1.html"><a href="3-6-exercises-1.html"><i class="fa fa-check"></i><b>3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-nrf.html"><a href="4-nrf.html"><i class="fa fa-check"></i><b>4</b> Nonlinear Regression Functions</a><ul>
<li class="chapter" data-level="4.1" data-path="4-1-a-general-strategy-for-modelling-nonlinear-regression-functions.html"><a href="4-1-a-general-strategy-for-modelling-nonlinear-regression-functions.html"><i class="fa fa-check"></i><b>4.1</b> A General Strategy for Modelling Nonlinear Regression Functions</a></li>
<li class="chapter" data-level="4.2" data-path="4-2-nfoasiv.html"><a href="4-2-nfoasiv.html"><i class="fa fa-check"></i><b>4.2</b> Nonlinear Functions of a Single Independent Variable</a><ul>
<li class="chapter" data-level="" data-path="4-2-nfoasiv.html"><a href="4-2-nfoasiv.html#polynomials"><i class="fa fa-check"></i>Polynomials</a></li>
<li class="chapter" data-level="" data-path="4-2-nfoasiv.html"><a href="4-2-nfoasiv.html#logarithms"><i class="fa fa-check"></i>Logarithms</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-3-interactions-between-independent-variables.html"><a href="4-3-interactions-between-independent-variables.html"><i class="fa fa-check"></i><b>4.3</b> Interactions Between Independent Variables</a></li>
<li class="chapter" data-level="4.4" data-path="4-4-nonlinear-effects-on-test-scores-of-the-student-teacher-ratio.html"><a href="4-4-nonlinear-effects-on-test-scores-of-the-student-teacher-ratio.html"><i class="fa fa-check"></i><b>4.4</b> Nonlinear Effects on Test Scores of the Student-Teacher Ratio</a></li>
<li class="chapter" data-level="4.5" data-path="4-5-exercises-2.html"><a href="4-5-exercises-2.html"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using <tt>R</tt> for Introduction to Econometrics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. You can also see the annotations of others: click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="exercises-2" class="section level2">
<h2><span class="header-section-number">4.5</span> Exercises</h2>
<div class="DCexercise">
<h4 id="correlation-and-nonlinearity-i" class="unnumbered">1. Correlation and (Non)linearity I</h4>
<p>Consider the estimated simple linear regression model <span class="math display">\[\widehat{medv_i} = 34.554 - 0.95\times lstat_i.\]</span></p>
<p>with <tt>medv</tt> (median house value) and <tt>lstat</tt> (percent of households with low socioeconomic status) being variables from the already known <tt>Boston</tt> dataset.</p>
<p>The <tt>lm()</tt> object of the above model is available as <tt>mod</tt> in your working environment. The package <tt>MASS</tt> has been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the correlation between <tt>medv</tt> and <tt>lstat</tt>.</p></li>
<li><p>Plot <tt>medv</tt> against <tt>lstat</tt> and add the regression line of the estimated model. What do you notice?</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">
        
  <code data-type="pre-exercise-code">
  library(MASS)
  mod <- lm(medv ~ lstat, data = Boston)
  </code>
  
  <code data-type="sample-code">
  # compute the correlation between medv and lstat
  
  
  # plot medv against lstat and add the regression line
  
  
  
  </code>
  
  <code data-type="solution">
  # Compute the correlation between medv and lstat
  cor(Boston$medv, Boston$lstat)
  
  # Plot medv against lstat and add the regression line
  plot(medv ~ lstat, data = Boston)
  abline(mod, col = "red")
  
  </code>
  
  <code data-type="sct">
  ex() %>% check_function("cor") %>% check_result() %>% check_equal()
  test_or(ex() %>% check_function("plot") %>% {
        check_arg(., "formula") %>% check_equal()
        check_arg(., "data") %>% check_equal()
      },
  ex() %>% override_solution("plot(Boston$lstat, Boston$medv)") %>% check_function("plot") %>% {
        check_arg(., "x") %>% check_equal()
        check_arg(., "y") %>% check_equal()
      },
  ex() %>% override_solution("plot(Boston$medv ~ Boston$lstat)") %>% check_function("plot") %>%
        check_arg("formula") %>% check_equal()
      )
  ex() %>% check_function("abline") #%>% check_arg("reg") %>% check_equal()
  success_msg("Correct! Although the correlation coefficient suggests that medv and lstat are negatively linearly dependent, the relationship between them clearly is nonlinear. Hence a simple linear regression specification is inappropriate here.")
  
  </code>
  
</div>
        

<p><strong>Hints:</strong></p>
<ul>
<li><p>You can use <tt>cor()</tt> to compute the correlation between variables.</p></li>
<li><p>You may use <tt>plot()</tt> and <tt>abline()</tt> to visualize regression results.</p></li>
</ul>
</div>
<div class="DCexercise">
<h4 id="correlation-and-nonlinearity-ii" class="unnumbered">2. Correlation and (Non)linearity II</h4>
<p>In the previous exercise we saw that the correlation between the dependent variable and the regressors is not useful for choosing the functional form of the model since it captures only the linear relationship.</p>
<p>As an alternative, consider the nonlinear specification</p>
<p><span class="math display">\[medv_i = \beta_0 + \beta_1\times\log(lstat_i) + u_i.\]</span></p>
<p>The package <tt>MASS</tt> has been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Conduct the regression from above and assign the result to <tt>log_mod</tt>.</p></li>
<li><p>Visualize your results by drawing a scatterplot and adding the corresponding regression line. In comparison to the previous exercise what do you notice now?</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">
  
  <code data-type="pre-exercise-code">
  library(MASS)
  </code>
  
  <code data-type="sample-code">
  # conduct the regression and assign it to mod_log
  
  
  # draw a scatterplot and add the corresponding regression line
  
  
  
  </code>
  
  <code data-type="solution">
  # conduct the regression and assign it to mod_log
  mod_log <- lm(medv ~ log(lstat), data = Boston)
  
  # draw a scatterplot and add the corresponding regression line
  plot(medv ~ log(lstat), data = Boston)
  abline(mod_log, col = "red")
  
  </code>
  
  <code data-type="sct">
  ex() %>% check_object("mod_log") %>% check_equal()
  test_or(ex() %>% check_function("plot") %>% {
        check_arg(., "formula") %>% check_equal()
        check_arg(., "data") %>% check_equal()
      },
  ex() %>% override_solution("plot(log(Boston$lstat), Boston$medv)") %>% check_function("plot") %>% {
        check_arg(., "x") %>% check_equal()
        check_arg(., "y") %>% check_equal()
      },
  ex() %>% override_solution("plot(Boston$medv ~ log(Boston$lstat))") %>% check_function("plot") %>%
        check_arg("formula") %>% check_equal()
      )
  ex() %>% check_function("abline") #%>% check_arg("reg") %>% check_equal()
  success_msg("Correct! Although the relationship is not perfectly linear, using a log transformation considerably improves our model fit and seems to be a reasonable model specification.")
  </code>
  
</div>


<p><strong>Hints:</strong></p>
<ul>
<li><p>Use <tt>lm()</tt> to conduct a regression.</p></li>
<li><p>As usual you can use <tt>plot()</tt> and <tt>abline()</tt> to visualize regression results.</p></li>
</ul>
</div>
<div class="DCexercise">
<h4 id="optimal-polynomial-order-sequential-testing" class="unnumbered">3. Optimal Polynomial Order — Sequential Testing</h4>
<p>Recall the following model from the previous exercise <span class="math display">\[medv_i = \beta_0 + \beta_1\times\log(lstat_i) + u_i.\]</span></p>
<p>We saw that this model specification seems to be a reasonable choice. However, a higher order polynomial may be more suited to describe the data. Therefore please try the following:</p>
<p>The packages <tt>AER</tt> and <tt>MASS</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Determine the optimal order of a polylog model using sequential testing. Assume a maximum polynomial order of <span class="math inline">\(r=4\)</span> and a significance level of <span class="math inline">\(\alpha=0.05\)</span>. We would like you to use a <tt>for()</tt> loop and recommend the following approach:</p>
<ol style="list-style-type: decimal">
<li>Estimate a model, say <tt>mod</tt>, which starts with the highest polynomial order.</li>
<li>Save the <span class="math inline">\(p\)</span>-value (use robust standard errors) of the relevant parameter and compare it to the significance level <span class="math inline">\(\alpha\)</span>.</li>
<li>If you cannot reject the null, repeat steps 1 and 2 for the next lowest polynomial order, otherwise stop the loop and print out the polynomial order.</li>
</ol></li>
<li><p>Extract the <span class="math inline">\(R^2\)</span> of the selected model and assign it to the variable <tt>R2</tt>.</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">
  
  <code data-type="pre-exercise-code">
  library(AER)
  library(MASS)
  </code>
  
  <code data-type="sample-code">
  # find the optimal polynomial order of the polylog model.
  
  
  
  
  
  
  
  
  
  # extract the R^2 from the selected model and assign it to R2.
  
  
  </code>
   
  <code data-type="solution">
  # find the optimal polynomial order of the polylog model.
  for(i in 4:1){
  mod  <- lm(medv ~ poly(log(lstat), i, raw = T), data = Boston)
  pval <- coeftest(mod, vcov = vcovHC)[(i+1), 4]
  if(pval < 0.05){
    print(i)
    break
    }
  }
  
  # extract the R^2 from the selected model and assign it to R2.
  R2 <- summary(mod)$r.squared
  
  </code>
  
  <code data-type="sct">
  ex() %>% check_for()
  ex() %>% check_object("R2") %>% check_equal()
  success_msg("Correct! Using the sequential testing approach we get an optimal order of r=2.")
  </code>
  
</div>


<p><strong>Hints:</strong></p>
<ul>
<li><p>The index for the <tt>for()</tt> loop should start at 4 and end at 1.</p></li>
<li><p>Using <tt>poly()</tt> in the argument <tt>formula</tt> of <tt>lm()</tt> is a generic way to incorporate higher orders of a certain variable in the model. Besides the variable, you have to specify the degree of the polynomial via the argument <tt>degree</tt> and set <tt>raw = TRUE</tt>.</p></li>
<li><p>Use <tt>coeftest()</tt> together with the argument <tt>vcov</tt> to obtain <span class="math inline">\(p\)</span>-values (with robust standard errors). Use the structure of the resulting object to extract the relevant <span class="math inline">\(p\)</span>-value.</p></li>
<li><p>An <tt>if()</tt> statement may be useful to check whether the condition for acceptance of the null in step 3 is fulfilled. A <tt>for()</tt> loop is stopped using the statement <tt>break</tt>.</p></li>
<li><p>Use <tt>summary()</tt> to obtain the <span class="math inline">\(R^2\)</span>. You may extract it by appending <tt>$r.squared</tt>.</p></li>
</ul>
</div>
<div class="DCexercise">
<h4 id="estimated-effect-of-a-unit-change" class="unnumbered">4. Estimated Effect of a Unit Change</h4>
<p>Reconsider the polylog model from the previous exercise that was selected by the sequential testing approach. As this model is logarithmic and of quadratic form, we cannot simply read off the estimated effect of a unit change in <tt>lstat</tt> from the coefficient summary. Instead we have to compute it manually. To do so, assume that we are interested in the effect of an increase in <tt>lstat</tt> from 10% to 11%.</p>
<p>The selected polylog model <tt>mod_pl</tt> is available in your working environment. The package <tt>MASS</tt> has been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Set up a <tt>data.frame</tt> with the relevant observations of <tt>lstat</tt>.</p></li>
<li><p>Use the new observations to predict the corresponding values of <tt>medv</tt>.</p></li>
<li><p>Compute the expected effect with the help of the function <tt>diff()</tt>.</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">
  
  <code data-type="pre-exercise-code">
  library(MASS)
  mod_pl  <- lm(medv ~ poly(log(lstat), 2, raw = T), data = Boston)  
  </code>
  
  <code data-type="sample-code">
  # set up the relevant data points.
  
  
  # predict the corresponding values of medv.
  
  
  # compute the expected effect of the change.
  
  
  </code>
   
  <code data-type="solution">
  # Set up the relevant data points.
  new_data <- data.frame(lstat = c(10, 11))
  
  # Predict the corresponding values of medv.
  Y_hat <- predict(mod_pl, newdata = new_data)
  
  # Compute the expected effect of the change.
  diff(Y_hat)
  
  </code>
  
  <code data-type="sct">
  ex() %>% check_object("new_data") %>% check_equal()
  ex() %>% check_object("Y_hat") %>% check_equal()
  ex() %>% check_function("diff") %>% check_result() %>% check_equal()
  success_msg("Correct! The expected change in medv for an increase in lstat from 10% to 11% is about -1.16 (that is -1160$).")
  </code>
  
</div>


<p><strong>Hints:</strong></p>
<ul>
<li><p>Note that the column names of the <tt>data.frame</tt> has to match the name of the regressor.</p></li>
<li><p>You may use <tt>predict()</tt> together with the new data to obtain the predicted values of <tt>medv</tt>.</p></li>
<li><p><tt>diff()</tt> expects a vector. It computes the differences between all entries of this vector.</p></li>
</ul>
</div>
<div class="DCexercise">
<h4 id="interactions-between-independent-variables-i" class="unnumbered">5. Interactions between Independent Variables I</h4>
<p>Consider the following regression model</p>
<p><span class="math display">\[medv_i=\beta_0+\beta_1\times chas_i+\beta_2\times old_i+\beta_3(chas_i\times old_i)+u_i\]</span></p>
<p>where <span class="math inline">\(chas_i\)</span> and <span class="math inline">\(old_i\)</span> are dummy variables. The former takes the value <span class="math inline">\(1\)</span>, if the Charles River (a short river in the proximity of Boston) passes through suburb <span class="math inline">\(i\)</span> and is <span class="math inline">\(0\)</span> otherwise. The latter accounts for a high proportion of old buildings and is constructed as follows</p>
<span class="math display">\[\begin{align}
old_i = &amp; \,
    \begin{cases}
      1 &amp; \text{if $age_i\geq 95$},\\
      0 &amp; \text{else},
    \end{cases}
\end{align}\]</span>
<p>with <span class="math inline">\(age_i\)</span> being the proportion of owner-occupied units built prior to 1940 in suburb <span class="math inline">\(i\)</span>.</p>
<p>The package <tt>MASS</tt> has been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Append the binary variable <tt>old</tt> to the dataset <tt>Boston</tt>.</p></li>
<li><p>Conduct the regression from above and assign the result to <tt>mod_bb</tt>.</p></li>
<li><p>Obtain a coefficient summary of the model. How do you interpret the results?</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">
  
  <code data-type="pre-exercise-code">
  library(MASS)
  </code>
  
  <code data-type="sample-code">
  # create the binary variable old and append it to the dataset
  
  
  # conduct the regression and assign it to mod_bb
  
  
  # print the summary to the console
  
  
  </code>
   
  <code data-type="solution">
  # create the binary variable old and append it to the dataset.
  Boston$old <- as.numeric(Boston$age >= 95)
  
  # conduct the regression and assign it to mod_bb.
  mod_bb <- lm(medv ~ chas*old, data = Boston)
  
  # print the summary to the console
  summary(mod_bb)
  
  </code>
  
  <code data-type="sct">
  ex() %>% check_object("Boston") %>%
  check_column("old", col_missing_msg = "Have you added the column `old` to `Boston`?") %>%
  check_equal(incorrect_msg = "Have you correctly calculated the column `old` based on `age`?")
  test_or({
    test_object("mod_bb")
  },{
    f <- ex() %>% override_solution("lm(medv ~ old*chas, data = Boston)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  },{
    f <- ex() %>% override_solution("lm(Boston$medv ~ Boston$chas*Boston$old)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  },{
    f <- ex() %>% override_solution("lm(Boston$medv ~ Boston$old*Boston$chas)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  },{
    f <- ex() %>% override_solution("attach(Boston);lm(medv ~ chas*old)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  },{
    f <- ex() %>% override_solution("attach(Boston);lm(medv ~ old*chas)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  },{
    f <- ex() %>% override_solution("lm(medv ~ chas + old + chas:old, data = Boston)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  },{
    f <- ex() %>% override_solution("lm(medv ~ old + chas + old:chas, data = Boston)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  },{
    f <- ex() %>% override_solution("lm(Boston$medv ~ Boston$chas + Boston$old + Boston$chas:Boston$old)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  },{
    f <- ex() %>% override_solution("lm(Boston$medv ~ Boston$old + Boston$chas + Boston$old:Boston$chas)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  },{
    f <- ex() %>% override_solution("attach(Boston);lm(medv ~ chas + old + chas:old)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  },{
    f <- ex() %>% override_solution("attach(Boston);lm(medv ~ old + chas + old:chas)") %>% check_function("lm")
    f %>% check_arg("formula") %>% check_equal()
  })
  ex() %>% check_function("summary") %>% check_arg("object") %>% check_equal(eval = F)
  success_msg("Correct! The estimated effect of moving from a suburb with a low proportion of old buildings to a one with a high proportion is -7.13 + 10.55 * chas. So depending on the passing of the Charles River through a suburb, the effect is positive or negative.")
  </code>
  
</div>


<p><strong>Hints:</strong></p>
<ul>
<li><p>Use the operator <tt>&gt;=</tt> to create a logical vector and transform it to the numeric type via <tt>as.numeric()</tt>.</p></li>
<li><p>Inside of <tt>lm()</tt> there are two ways to incorporate interaction terms using <tt>formula</tt> (see <tt>?formula</tt>):</p>
<ol style="list-style-type: decimal">
<li><tt>Var1*Var2</tt> to add <tt>Var1</tt>, <tt>Var2</tt> and the corresponding interaction term at once.<br />
</li>
<li><tt>Var1:Var2</tt> to manually add the interaction term (which of course requires you to add the remaining terms manually as well)</li>
</ol></li>
<li><p>Use <tt>summary()</tt> to get a comprehensive overview of the results.</p></li>
</ul>
</div>
<div class="DCexercise">
<h4 id="interactions-between-independent-variables-ii" class="unnumbered">6. Interactions between Independent Variables II</h4>
<p>Now consider the regression model</p>
<p><span class="math display">\[medv_i=\beta_0+\beta_1\times indus_i+\beta_2\times old_i+\beta_3(indus_i\times old_i)+u_i\]</span></p>
<p>with <span class="math inline">\(old_i\)</span> defined as in the previous exercise and <span class="math inline">\(indus_i\)</span> being the proportion of non-retail business acres per suburb.</p>
<p>The vector <tt>old</tt> from the previous exercise has been appended to the dataset. The package <tt>MASS</tt> has been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Conduct the regression from above and assign it to <tt>mod_bc</tt>.</p></li>
<li><p>Extract the estimated coefficients of the model and assign them to <tt>params</tt>.</p></li>
<li><p>Plot <tt>medv</tt> against <tt>indus</tt> and add the regression lines for both states of the binary variable <span class="math inline">\(old\)</span>.</p></li>
</ul>


<div data-datacamp-exercise data-lang="r">
  
  <code data-type="pre-exercise-code">
  library(MASS)
  Boston$old <- as.numeric(Boston$age >= 95)
  </code>
  
  <code data-type="sample-code">
  # conduct the regression and assign it to mod_bc.
  
  
  # extract the estimated model coefficients and assign them to params.
  
  
  # plot medv against indus and add the regression lines.
  
  
  
  
  </code>
   
  <code data-type="solution">
  # conduct the regression and assign it to mod_bc.
  mod_bc <- lm(medv ~ indus*old, data = Boston)
  
  # extract the estimated model coefficients and assign them to params.
  params <- coef(mod_bc)
  
  # plot medv against indus and add the regression lines.
  plot(medv ~ indus, data = Boston)
  abline(a = params[1], b = params[2], col = "red")
  abline(a = params[1] + params[3], b = params[2] + params[4], col = "darkblue")
  
  </code>
  
  <code data-type="sct">
  test_or({
      test_object("mod_bc")
    },{
      f <- ex() %>% override_solution("lm(medv ~ old*indus, data = Boston)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    },{
      f <- ex() %>% override_solution("lm(Boston$medv ~ Boston$indus*Boston$old)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    },{
      f <- ex() %>% override_solution("lm(Boston$medv ~ Boston$old*Boston$indus)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    },{
      f <- ex() %>% override_solution("attach(Boston);lm(medv ~ indus*old)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    },{
      f <- ex() %>% override_solution("attach(Boston);lm(medv ~ old*indus)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    },{
      f <- ex() %>% override_solution("lm(medv ~ indus + old + indus:old, data = Boston)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    },{
      f <- ex() %>% override_solution("lm(medv ~ old + indus + old:indus, data = Boston)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    },{
      f <- ex() %>% override_solution("lm(Boston$medv ~ Boston$indus + Boston$old + Boston$indus:Boston$old)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    },{
      f <- ex() %>% override_solution("lm(Boston$medv ~ Boston$old + Boston$indus + Boston$old:Boston$indus)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    },{
      f <- ex() %>% override_solution("attach(Boston);lm(medv ~ indus + old + indus:old)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    },{
      f <- ex() %>% override_solution("attach(Boston);lm(medv ~ old + indus + old:indus)") %>% check_function("lm")
      f %>% check_arg("formula") %>% check_equal()
    })
  ex() %>% check_object("params") %>% check_equal()
  test_or({
      ex() %>% check_function("plot") %>% {
          check_arg(., "formula") %>% check_equal()
          check_arg(., "data") %>% check_equal()
    }},{
      f <- ex() %>% override_solution("plot(Boston$indus, Boston$medv)") %>% check_function("plot")
      f %>% {
          check_arg(., "x") %>% check_equal()
          check_arg(., "y") %>% check_equal()
    }},{
      f <- ex() %>% override_solution("plot(Boston$medv ~ Boston$indus)") %>% check_function("plot")
      f %>% check_arg("formula") %>% check_equal()
  })
  test_or({
      ex() %>% check_function("abline", index = 1) %>% {
          check_arg(., "a") %>% check_equal()
          check_arg(., "b") %>% check_equal()
      }
      ex() %>% check_function("abline", index = 2) %>% {
          check_arg(., "a") %>% check_equal()
          check_arg(., "b") %>% check_equal()
      }},{
      f <- ex() %>% override_solution("abline(a = params[1], b = params[2]);abline(coef = c(params[1] + params[3], params[2] + params[4]))")
      f %>% check_function("abline", index = 1) %>% {
          check_arg(., "a") %>% check_equal()
          check_arg(., "b") %>% check_equal()
      }
      f %>% check_function("abline", index = 2) %>% check_arg("coef") %>% check_equal()
      },{
      f <- ex() %>% override_solution("abline(coef = c(params[1], params[2]));abline(coef = c(params[1] + params[3], params[2] + params[4]))")
      f %>% check_function("abline", index = 1) %>% check_arg("coef") %>% check_equal()
      f %>% check_function("abline", index = 2) %>% check_arg("coef") %>% check_equal()
      },{
      f <- ex() %>% override_solution("abline(coef = c(params[1], params[2]));abline(a = params[1] + params[3], b = params[2] + params[4])")
      f %>% check_function("abline", index = 1) %>% check_arg("coef") %>% check_equal()
      f %>% check_function("abline", index = 2) %>% {
          check_arg(., "a") %>% check_equal()
          check_arg(., "b") %>% check_equal()
      }})
  success_msg("Correct! We see that the decrease in the median house value due to the proportion of industrial buildings is absolutely smaller in suburbs with a high proportion of old buildings.")
  </code>
  
</div>


<p><strong>Hints:</strong></p>
<ul>
<li><p>You may use the structure of <tt>mod_bc</tt> or <tt>coef()</tt> to extract the estimated coefficients.</p></li>
<li><p>Besides passing a <tt>lm()</tt> object to <tt>abline()</tt>, one may also manually specify intercept and slope using the arguments <tt>a</tt> and <tt>b</tt>, respectively.</p></li>
</ul>
</div>

<div id="refs" class="references">
<div>
<p>Allaire, J., Xie, Y., McPherson, J., Luraschi, J., Ushey, K., Atkins, A., … Chang, W. (2018). <em>Rmarkdown: Dynamic documents for r</em>. Retrieved from <a href="https://CRAN.R-project.org/package=rmarkdown" class="uri">https://CRAN.R-project.org/package=rmarkdown</a></p>
</div>
<div>
<p>Heiss, F. (2016). <em>Using R for Introductory Econometrics</em>. CreateSpace Independent Publishing Platform.</p>
</div>
<div>
<p>Hlavac, M. (2018). <em>Stargazer: Well-formatted regression and summary statistics tables</em>. Retrieved from <a href="https://CRAN.R-project.org/package=stargazer" class="uri">https://CRAN.R-project.org/package=stargazer</a></p>
</div>
<div>
<p>Kleiber, C., &amp; Zeileis, A. (2008). <em>Applied Econometrics with R</em>. Springer.</p>
</div>
<div>
<p>Kleiber, C., &amp; Zeileis, A. (2017). <em>AER: Applied econometrics with r</em>. Retrieved from <a href="https://CRAN.R-project.org/package=AER" class="uri">https://CRAN.R-project.org/package=AER</a></p>
</div>
<div>
<p>MacKinnon, J. G., &amp; White, H. (1985). Some heteroskedasticity-consistent covariance matrix estimators with improved finite sample properties. <em>Journal of Econometrics</em>, <em>29</em>(3), 305–325.</p>
</div>
<div>
<p>R Core Team. (2018). <em>R: A language and environment for statistical computing</em>. Vienna, Austria: R Foundation for Statistical Computing. Retrieved from <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a></p>
</div>
<div>
<p>Ripley, B. (2018). <em>MASS: Support functions and datasets for venables and ripley’s mass</em>. Retrieved from <a href="https://CRAN.R-project.org/package=MASS" class="uri">https://CRAN.R-project.org/package=MASS</a></p>
</div>
<div>
<p>Stock, J., &amp; Watson, M. (2015). <em>Introduction to Econometrics, Third Update, Global Edition</em>. Pearson Education Limited.</p>
</div>
<div>
<p>White, H. (1980). A Heteroskedasticity-Consistent Covariance Matrix Estimator and a Direct Test for Heteroskedasticity. <em>Econometrica</em>, <em>48</em>(4), pp. 817–838.</p>
</div>
<div>
<p>Wickham, H. (2017). <em>Scales: Scale functions for visualization</em>. Retrieved from <a href="https://CRAN.R-project.org/package=scales" class="uri">https://CRAN.R-project.org/package=scales</a></p>
</div>
<div>
<p>Wooldridge, J. (2016). <em>Introductory Econometrics</em> (Sixth). Cengage Learning.</p>
</div>
<div>
<p>Xie, Y. (2018). <em>Knitr: A general-purpose package for dynamic report generation in r</em>. Retrieved from <a href="https://CRAN.R-project.org/package=knitr" class="uri">https://CRAN.R-project.org/package=knitr</a></p>
</div>
</div>
</div>
<!-- </div> -->









            </section>

          </div>
        </div>
      </div>
<a href="4-4-nonlinear-effects-on-test-scores-of-the-student-teacher-ratio.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 1
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
