<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Econometrics with R</title>
  <meta name="description" content="<em>Introduction to Econometrics with R</em> is an interactive companion to the well-received textbook <em>Introduction to Econometrics</em> by James H. Stock and Mark W. Watson (2015). It guides students in implementing the empirical applications presented throughout the book using the statistical software package R.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Econometrics with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="<em>Introduction to Econometrics with R</em> is an interactive companion to the well-received textbook <em>Introduction to Econometrics</em> by James H. Stock and Mark W. Watson (2015). It guides students in implementing the empirical applications presented throughout the book using the statistical software package R." />
  <meta name="github-repo" content="Emwikts1970/URFITE-Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Econometrics with R" />
  
  <meta name="twitter:description" content="<em>Introduction to Econometrics with R</em> is an interactive companion to the well-received textbook <em>Introduction to Econometrics</em> by James H. Stock and Mark W. Watson (2015). It guides students in implementing the empirical applications presented throughout the book using the statistical software package R." />
  <meta name="twitter:image" content="images/cover.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="3-1-TIVEWASRAASI.html">
<link rel="next" href="3-3-civ.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- font families -->

<link href="https://fonts.googleapis.com/css?family=PT+Sans|Pacifico|Source+Sans+Pro" rel="stylesheet">

<!-- function to adjust height of iframes automatically depending on content loaded -->

<script>
  function resizeIframe(obj) {
    obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
  }
</script>

<script src="js/hideOutput.js"></script>
<script type="text/javascript" src="MathJax-2.7.2/MathJax.js?config=default"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script async defer src="https://hypothes.is/embed.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://www.oek.wiwi.uni-due.de/en/">Chair of Econometrics @ Uni-DUE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="1-introduction.html"><a href="1-introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-a-very-short-introduction-to-r-and-rstudio.html"><a href="1-1-a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.1</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-lrwor.html"><a href="2-lrwor.html"><i class="fa fa-check"></i><b>2</b> Linear Regression with One Regressor</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-simple-linear-regression.html"><a href="2-1-simple-linear-regression.html"><i class="fa fa-check"></i><b>2.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="2.2" data-path="2-2-estimating-the-coefficients-of-the-linear-regression-model.html"><a href="2-2-estimating-the-coefficients-of-the-linear-regression-model.html"><i class="fa fa-check"></i><b>2.2</b> Estimating the Coefficients of the Linear Regression Model</a><ul>
<li class="chapter" data-level="" data-path="2-2-estimating-the-coefficients-of-the-linear-regression-model.html"><a href="2-2-estimating-the-coefficients-of-the-linear-regression-model.html#the-ordinary-least-squares-estimator"><i class="fa fa-check"></i>The Ordinary Least Squares Estimator</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-3-measures-of-fit.html"><a href="2-3-measures-of-fit.html"><i class="fa fa-check"></i><b>2.3</b> Measures of Fit</a><ul>
<li class="chapter" data-level="" data-path="2-3-measures-of-fit.html"><a href="2-3-measures-of-fit.html#the-coefficient-of-determination"><i class="fa fa-check"></i>The Coefficient of Determination</a></li>
<li class="chapter" data-level="" data-path="2-3-measures-of-fit.html"><a href="2-3-measures-of-fit.html#the-standard-error-of-the-regression"><i class="fa fa-check"></i>The Standard Error of the Regression</a></li>
<li class="chapter" data-level="" data-path="2-3-measures-of-fit.html"><a href="2-3-measures-of-fit.html#application-to-the-test-score-data"><i class="fa fa-check"></i>Application to the Test Score Data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-4-tlsa.html"><a href="2-4-tlsa.html"><i class="fa fa-check"></i><b>2.4</b> The Least Squares Assumptions</a><ul>
<li class="chapter" data-level="" data-path="2-4-tlsa.html"><a href="2-4-tlsa.html#assumption-1-the-error-term-has-conditional-mean-of-zero"><i class="fa fa-check"></i>Assumption 1: The Error Term has Conditional Mean of Zero</a></li>
<li class="chapter" data-level="" data-path="2-4-tlsa.html"><a href="2-4-tlsa.html#assumption-2-independently-and-identically-distributed-data"><i class="fa fa-check"></i>Assumption 2: Independently and Identically Distributed Data</a></li>
<li class="chapter" data-level="" data-path="2-4-tlsa.html"><a href="2-4-tlsa.html#assumption-3-large-outliers-are-unlikely"><i class="fa fa-check"></i>Assumption 3: Large Outliers are Unlikely</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-5-tsdotoe.html"><a href="2-5-tsdotoe.html"><i class="fa fa-check"></i><b>2.5</b> The Sampling Distribution of the OLS Estimator</a><ul>
<li class="chapter" data-level="" data-path="2-5-tsdotoe.html"><a href="2-5-tsdotoe.html#simulation-study-1"><i class="fa fa-check"></i>Simulation Study 1</a></li>
<li class="chapter" data-level="" data-path="2-5-tsdotoe.html"><a href="2-5-tsdotoe.html#simulation-study-2"><i class="fa fa-check"></i>Simulation Study 2</a></li>
<li class="chapter" data-level="" data-path="2-5-tsdotoe.html"><a href="2-5-tsdotoe.html#simulation-study-3"><i class="fa fa-check"></i>Simulation Study 3</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-6-exercises.html"><a href="2-6-exercises.html"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-ivr.html"><a href="3-ivr.html"><i class="fa fa-check"></i><b>3</b> Instrumental Variables Regression</a><ul>
<li class="chapter" data-level="3.1" data-path="3-1-TIVEWASRAASI.html"><a href="3-1-TIVEWASRAASI.html"><i class="fa fa-check"></i><b>3.1</b> The IV Estimator with a Single Regressor and a Single Instrument</a></li>
<li class="chapter" data-level="3.2" data-path="3-2-TGIVRM.html"><a href="3-2-TGIVRM.html"><i class="fa fa-check"></i><b>3.2</b> The General IV Regression Model</a></li>
<li class="chapter" data-level="3.3" data-path="3-3-civ.html"><a href="3-3-civ.html"><i class="fa fa-check"></i><b>3.3</b> Checking Instrument Validity</a></li>
<li class="chapter" data-level="3.4" data-path="3-4-attdfc.html"><a href="3-4-attdfc.html"><i class="fa fa-check"></i><b>3.4</b> Application to the Demand for Cigarettes</a></li>
<li class="chapter" data-level="3.5" data-path="3-5-where-do-valid-instruments-come-from.html"><a href="3-5-where-do-valid-instruments-come-from.html"><i class="fa fa-check"></i><b>3.5</b> Where Do Valid Instruments Come From?</a></li>
<li class="chapter" data-level="3.6" data-path="3-6-exercises-1.html"><a href="3-6-exercises-1.html"><i class="fa fa-check"></i><b>3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Introduction to Econometrics with R</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. You can also see the annotations of others: click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="TGIVRM" class="section level2">
<h2><span class="header-section-number">3.2</span> The General IV Regression Model</h2>
<p>The simple IV regression model is easily extended to a multiple regression model which we refer to as the general IV regression model. In this model we distinguish between four types of variables: the dependent variable, included exogenous variables, included endogenous variables and instrumental variables. Key Concept 12.1 summarizes the model and the common terminology. See Chapter 12.2 of the book for a more comprehensive discussion of the individual components of the general model.</p>
<div class="keyconcept">
<h3 class="right">
Key Concept 12.1
</h3>
<h3 class="left">
The General Instrumental Variables Regression Model and Terminology
</h3>
<span class="math display" id="eq:givmodel">\[\begin{align}
  Y_i = \beta_0 + \beta_1 X_{1i} + \dots + \beta_k X_{ki} + \beta_{k+1} W_{1i} + \dots + \beta_{k+r} W_{ri} + u_i, \tag{3.5}
\end{align}\]</span>
<p>with <span class="math inline">\(i=1,\dots,n\)</span> is the general instrumental variables regression model where</p>
<ul>
<li><p><span class="math inline">\(Y_i\)</span> is the dependent variable</p></li>
<li><p><span class="math inline">\(\beta_0,\dots,\beta_{k+1}\)</span> are <span class="math inline">\(1+k+r\)</span> unknown regression coefficients</p></li>
<li><p><span class="math inline">\(X_{1i},\dots,X_{ki}\)</span> are <span class="math inline">\(k\)</span> endogenous regressors</p></li>
<li><p><span class="math inline">\(W_{1i},\dots,W_{ri}\)</span> are <span class="math inline">\(r\)</span> exogenous regressors which are uncorrelated with <span class="math inline">\(u_i\)</span></p></li>
<li><p><span class="math inline">\(u_i\)</span> is the error term</p></li>
<li><p><span class="math inline">\(Z_{1i},\dots,Z_{mi}\)</span> are <span class="math inline">\(m\)</span> instrumental variables</p></li>
</ul>
<p>The coefficients are overidentified if <span class="math inline">\(m&gt;k\)</span>. If <span class="math inline">\(m&lt;k\)</span>, the coefficients are underidentified and when <span class="math inline">\(m=k\)</span> they are exactly identified. For estimation of the IV regression model we require exact identification or overidentification.</p>
</div>
<p>While computing both stages of TSLS individually is not a big deal in <a href="3-1-TIVEWASRAASI.html#eq:srm12">(3.1)</a>, the simple regression model with a single endogenous regressor, Key Concept 12.2 clarifies why resorting to TSLS functions like <tt>ivreg()</tt> are more convenient when the set of potentially endogenous regressors (and instruments) is large.</p>
<p>Estimating regression models with TSLS using multiple instruments by means of <tt>ivreg()</tt> is straightforward. There are, however, some subtleties in correctly specifying the regression formula.</p>
<p>Assume that you want to estimate the model <span class="math display">\[Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + W_{1i} + u_i\]</span> where <span class="math inline">\(X_{1i}\)</span> and <span class="math inline">\(X_{2i}\)</span> are endogenous regressors that shall be instrumented by <span class="math inline">\(Z_{1i}\)</span>, <span class="math inline">\(Z_{2i}\)</span> and <span class="math inline">\(Z_{3i}\)</span> and <span class="math inline">\(W_{1i}\)</span> is an exogenous regressor. The corresponding data is available in a <tt>data.frame</tt> with column names <tt>y</tt>, <tt>x1</tt>, <tt>x1</tt>, <tt>w1</tt>, <tt>z1</tt>, <tt>z2</tt> and <tt>z3</tt>. It might be tempting to specify the argument <tt>formula</tt> in your call of <tt>ivreg()</tt> as <tt>y ~ x1 + x2 + w1 | z1 + z2 + z3</tt> which is wrong. As explained in the documentation of <tt>ivreg()</tt> (see <code>?ivreg</code>), it is necessary to list <em>all</em> exogenous variables as instruments too, that is joining them by <tt>+</tt>’s on the right of the vertical bar: <tt>y ~ x1 + x2 + w1 | w1 + z1 + z2 + z3</tt> where <tt>w1</tt> is “instrumenting itself”.</p>
<p>If there is a large number of exogenous variables it may be convenient to provide an update formula with a <tt>.</tt> (this includes all variables except for the dependent variable) right after the <tt>|</tt> and to exclude all endogenous variables using a <tt>-</tt>. For example, if there is one exogenous regressor <tt>w1</tt> and one endogenous regressor <tt>x1</tt> with instrument <tt>z1</tt>, the appropriate formula would be <tt>y ~ w1 + x1 | w1 + z1</tt> which is equivalent to <tt>y ~ w1 + x1 | . - x1 + z1</tt>.</p>
<div class="keyconcept">
<h3 class="right">
Key Concept 12.2
</h3>
<h3 class="left">
Two-Stage Least Squares
</h3>
<p>Similarly to the simple IV regression model, the general IV model <a href="3-2-TGIVRM.html#eq:givmodel">(3.5)</a> can be estimated using the two-stage least squares estimator:</p>
<ol style="list-style-type: decimal">
<li><p><strong>First-stage regression(s)</strong></p>
<p>Run an OLS regression for each of the endogenous variables (<span class="math inline">\(X_{1i},\dots,X_{ki}\)</span>) on all instrumental variables (<span class="math inline">\(Z_{1i},\dots,Z_{mi}\)</span>), all exogenous variables (<span class="math inline">\(W_{1i},\dots,W_{ri}\)</span>) and an intercept. Compute the fitted values (<span class="math inline">\(\widehat{X}_{1i},\dots,\widehat{X}_{ki}\)</span>).</p></li>
<li><p><strong>Second-stage regression</strong></p>
Regress the dependent variable on the predicted values of all endogenous regressors, all exogenous variables and an intercept using OLS. This gives <span class="math inline">\(\widehat{\beta}_{0}^{TSLS},\dots,\widehat{\beta}_{k+r}^{TSLS}\)</span>, the TSLS estimates of the model coefficients.</li>
</ol>
</div>
<p>In the general IV regression model, the instrument relevance and instrument exogeneity assumptions are the same as in the simple regression model with a single endogenous regressor and only one instrument. See Key Concept 12.3 for a recap using the terminology of general IV regression.</p>
<div class="keyconcept">
<h3 class="right">
Key Concept 12.3
</h3>
<h3 class="left">
Two Conditions for Valid Instruments
</h3>
<p>For <span class="math inline">\(Z_{1i},\dots,Z_{mi}\)</span> to be a set of valid instruments, the following two conditions must be fulfilled:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Instrument Relevance</strong>:</p>
<p>if there are <span class="math inline">\(k\)</span> endogenous variables, <span class="math inline">\(r\)</span> exogenous variables and <span class="math inline">\(m\geq k\)</span> instruments <span class="math inline">\(Z\)</span> and the <span class="math inline">\(\widehat{X}_{1i}^*,\dots,\widehat{X}_{ki}^*\)</span> are the predicted values from the <span class="math inline">\(k\)</span> population first stage regressions, it must hold that <span class="math display">\[(\widehat{X}_{1i}^*,\dots,\widehat{X}_{ki}^*, W_{1i}, \dots, W_{ri},1)\]</span> are not perfectly multicollinear. <span class="math inline">\(1\)</span> denotes the constant regressor which equals <span class="math inline">\(1\)</span> for all observations.</p>
<p><em>Note</em>: If there is only one endogenous regressor <span class="math inline">\(X_i\)</span>, there must be at least one non-zero coefficient on the <span class="math inline">\(Z\)</span> and the <span class="math inline">\(W\)</span> in the population regression for this condition to be valid: if all of the coefficients are zero, all the <span class="math inline">\(\widehat{X}^*_i\)</span> are just the mean of <span class="math inline">\(X\)</span> such that there is perfect multicollinearity.</p></li>
<li><p><strong>Instrument Exogeneity</strong>:</p>
<p>All <span class="math inline">\(m\)</span> instruments must be uncorrelated with the error term,</p>
<p><span class="math display">\[\rho_{Z_{1i},u_i} = 0,\dots,\rho_{Z_{mi},u_i} = 0.\]</span></p></li>
</ol>
</div>
<p>One can show that if the IV regression assumptions presented in Key Concept 12.4 hold, the TSLS estimator in <a href="3-2-TGIVRM.html#eq:givmodel">(3.5)</a> is consistent and normally distributed when the sample size is large. Appendix 12.3 of the book deals with a proof in the special case with a single regressor, a single instrument and no exogenous variables. The reasoning behind this carries over to the general IV model. Chapter 18 of the book proves a more complicated explanation for the general case.</p>
<p>For our purposes it is sufficient to bear in mind that validity of the assumptions stated in Key Concept 12.4 allows us to obtain valid statistical inference using <tt>R</tt> functions which compute <span class="math inline">\(t\)</span>-Tests, <span class="math inline">\(F\)</span>-Tests and confidence intervals for model coefficients.</p>
<div class="keyconcept">
<h3 class="right">
Key Concept 12.4
</h3>
<h3 class="left">
The IV Regression Assumptions
</h3>
<p>For the general IV regression model in Key Concept 12.1 we assume the following:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(E(u_i\vert W_{1i}, \dots, W_{ri}) = 0.\)</span></p></li>
<li><p><span class="math inline">\((X_{1i},\dots,X_{ki},W_{1i},\dots,W_{ri},Z_{1i},\dots,Z_{mi})\)</span> are i.i.d. draws from their joint distribution.</p></li>
<li><p>All variables have nonzero finite fourth moments, i.e., outliers are unlikely.</p></li>
<li><p>The <span class="math inline">\(Z\)</span>s are valid instruments (see Key Concept 12.3).</p></li>
</ol>
</div>
<div id="application-to-the-demand-for-cigarettes-1" class="section level4 unnumbered">
<h4>Application to the Demand for Cigarettes</h4>
<p>The estimated elasticity of the demand for cigarettes in <a href="3-1-TIVEWASRAASI.html#eq:srm12">(3.1)</a> is <span class="math inline">\(1.08\)</span>. Although <a href="3-1-TIVEWASRAASI.html#eq:srm12">(3.1)</a> was estimated using IV regression it is plausible that this IV estimate is biased: in this model, the TSLS estimator is inconsistent for the true <span class="math inline">\(\beta_1\)</span> if the instrument (the real sales tax per pack) correlates with the error term. This is likely to be the case since there are economic factors, like state income, which impact the demand for cigarettes and correlate with the sales tax. States with high personal income tend to generate tax revenues by income taxes and less by sales taxes. Consequently, state income should be included in the regression model.</p>
<span class="math display" id="eq:mcigstsls1">\[\begin{align}
  \log(Q_i^{cigarettes}) = \beta_0 + \beta_1 \log(P_i^{cigarettes}) + \beta_2 \log(income_i) + u_i \tag{3.6}
\end{align}\]</span>
<p>Before estimating <a href="3-2-TGIVRM.html#eq:mcigstsls1">(3.6)</a> using <tt>ivreg()</tt> we define <span class="math inline">\(income\)</span> as real per capita income <tt>rincome</tt> and append it to the data set <tt>CigarettesSW</tt>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># add rincome to the dataset</span>
CigarettesSW<span class="op">$</span>rincome &lt;-<span class="st"> </span><span class="kw">with</span>(CigarettesSW, income <span class="op">/</span><span class="st"> </span>population <span class="op">/</span><span class="st"> </span>cpi)

c1995 &lt;-<span class="st"> </span><span class="kw">subset</span>(CigarettesSW, year <span class="op">==</span><span class="st"> &quot;1995&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate the model</span>
cig_ivreg2 &lt;-<span class="st"> </span><span class="kw">ivreg</span>(<span class="kw">log</span>(packs) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(rprice) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(rincome) <span class="op">|</span><span class="st"> </span><span class="kw">log</span>(rincome) <span class="op">+</span><span class="st"> </span>
<span class="st">                    </span>salestax, <span class="dt">data =</span> c1995)

<span class="kw">coeftest</span>(cig_ivreg2, <span class="dt">vcov =</span> vcovHC, <span class="dt">type =</span> <span class="st">&quot;HC1&quot;</span>)</code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##              Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)   9.43066    1.25939  7.4883 1.935e-09 ***
## log(rprice)  -1.14338    0.37230 -3.0711  0.003611 ** 
## log(rincome)  0.21452    0.31175  0.6881  0.494917    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We obtain</p>
<span class="math display" id="eq:emcigstsls2">\[\begin{align}
  \widehat{\log(Q_i^{cigarettes})} = \underset{(1.26)}{9.42} - \underset{(0.37)}{1.14} \log(P_i^{cigarettes}) + \underset{(0.31)}{0.21} \log(income_i). \tag{3.7}
\end{align}\]</span>
<p>Following the book we add the cigarette-specific taxes (<span class="math inline">\(cigtax_i\)</span>) as a further instrumental variable and estimate again using TSLS.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># add cigtax to the data set</span>
CigarettesSW<span class="op">$</span>cigtax &lt;-<span class="st"> </span><span class="kw">with</span>(CigarettesSW, tax<span class="op">/</span>cpi)

c1995 &lt;-<span class="st"> </span><span class="kw">subset</span>(CigarettesSW, year <span class="op">==</span><span class="st"> &quot;1995&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate the model</span>
cig_ivreg3 &lt;-<span class="st"> </span><span class="kw">ivreg</span>(<span class="kw">log</span>(packs) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(rprice) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(rincome) <span class="op">|</span><span class="st"> </span>
<span class="st">                    </span><span class="kw">log</span>(rincome) <span class="op">+</span><span class="st"> </span>salestax <span class="op">+</span><span class="st"> </span>cigtax, <span class="dt">data =</span> c1995)

<span class="kw">coeftest</span>(cig_ivreg3, <span class="dt">vcov =</span> vcovHC, <span class="dt">type =</span> <span class="st">&quot;HC1&quot;</span>)</code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##              Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)   9.89496    0.95922 10.3157 1.947e-13 ***
## log(rprice)  -1.27742    0.24961 -5.1177 6.211e-06 ***
## log(rincome)  0.28040    0.25389  1.1044    0.2753    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Using the two instruments <span class="math inline">\(salestax_i\)</span> and <span class="math inline">\(cigtax_i\)</span> we have <span class="math inline">\(m=2\)</span> and <span class="math inline">\(k=1\)</span> so the coefficient on the endogenous regressor <span class="math inline">\(\log(P_i^{cigarettes})\)</span> is <em>overidentified</em>. The TSLS estimate of <a href="3-2-TGIVRM.html#eq:mcigstsls1">(3.6)</a> is</p>
<span class="math display" id="eq:emcigstsls3">\[\begin{align}
  \widehat{\log(Q_i^{cigarettes})} = \underset{(0.96)}{9.89} - \underset{(0.25)}{1.28} \log(P_i^{cigarettes}) + \underset{(0.25)}{0.28} \log(income_i). \tag{3.8}
\end{align}\]</span>
<p>Should we trust the estimates presented in <a href="3-2-TGIVRM.html#eq:emcigstsls2">(3.7)</a> or rather rely on <a href="3-2-TGIVRM.html#eq:emcigstsls3">(3.8)</a>? The estimates obtained using both instruments are more precise since in <a href="3-2-TGIVRM.html#eq:emcigstsls3">(3.8)</a> all standard errors reported are smaller than in <a href="3-2-TGIVRM.html#eq:emcigstsls2">(3.7)</a>. In fact, the standard error for the estimate of the demand elasticity is only two thirds of the standard error when the sales tax is the only instrument used. This is due to more information being used in estimation <a href="3-2-TGIVRM.html#eq:emcigstsls3">(3.8)</a>. <em>If</em> the instruments are valid, <a href="3-2-TGIVRM.html#eq:emcigstsls3">(3.8)</a> can be considered more reliable.</p>
<p>However, without insights regarding the validity of the instruments it is not sensible to make such a statement. This stresses why checking instrument validity is essential. Chapter <a href="3-3-civ.html#civ">3.3</a> briefly discusses guidelines in checking instrument validity and presents approaches that allow to test for instrument relevance and exogeneity under certain conditions. These are then used in an application to the demand for cigarettes in Chapter <a href="3-4-attdfc.html#attdfc">3.4</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="3-1-TIVEWASRAASI.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="3-3-civ.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": true,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 1
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
