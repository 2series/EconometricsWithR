<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Using R for Introduction to Econometrics</title>
  <meta name="description" content="Using <tt>R</tt> for Introduction to Econometrics">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Using R for Introduction to Econometrics" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="Emwikts1970/URFITE-Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Using R for Introduction to Econometrics" />
  
  
  

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber and Martin Schmelzer">


<meta name="date" content="2018-07-30">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="PDWTTP.html">
<link rel="next" href="regression-with-time-fixed-effects.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="js/hideOutput.js"></script>
<script type="text/javascript" src="MathJax-2.7.2/MathJax.js?config=default"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script async defer src="https://hypothes.is/embed.js"></script>

<!-- datacamp-light-latest -->

<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>


<!-- <script src="js/d3.v3.min.js"></script>
<script src="js/leastsquares.js"></script>
<script src="js/d3functions.js"></script>
<script src="d3.slider.js"></script>
<script src="slrm.js"></script> -->


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">URFITE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="a-very-short-introduction-to-r-and-rstudio.html"><a href="a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.1</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rwpd.html"><a href="rwpd.html"><i class="fa fa-check"></i><b>2</b> Regression with Panel Data</a><ul>
<li class="chapter" data-level="2.1" data-path="panel-data.html"><a href="panel-data.html"><i class="fa fa-check"></i><b>2.1</b> Panel Data</a></li>
<li class="chapter" data-level="2.2" data-path="PDWTTP.html"><a href="PDWTTP.html"><i class="fa fa-check"></i><b>2.2</b> Panel Data with Two Time Periods: “Before and After” Comparisons</a></li>
<li class="chapter" data-level="2.3" data-path="fixed-effects-regression.html"><a href="fixed-effects-regression.html"><i class="fa fa-check"></i><b>2.3</b> Fixed Effects Regression</a><ul>
<li class="chapter" data-level="" data-path="fixed-effects-regression.html"><a href="fixed-effects-regression.html#estimation-and-inference"><i class="fa fa-check"></i>Estimation and Inference</a></li>
<li class="chapter" data-level="" data-path="fixed-effects-regression.html"><a href="fixed-effects-regression.html#application-to-traffic-deaths"><i class="fa fa-check"></i>Application to Traffic Deaths</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="regression-with-time-fixed-effects.html"><a href="regression-with-time-fixed-effects.html"><i class="fa fa-check"></i><b>2.4</b> Regression with Time Fixed Effects</a></li>
<li class="chapter" data-level="2.5" data-path="tferaaseffer.html"><a href="tferaaseffer.html"><i class="fa fa-check"></i><b>2.5</b> The Fixed Effects Regression Assumptions and Standard Errors for Fixed Effects Regression</a></li>
<li class="chapter" data-level="2.6" data-path="drunk-driving-laws-and-traffic-deaths.html"><a href="drunk-driving-laws-and-traffic-deaths.html"><i class="fa fa-check"></i><b>2.6</b> Drunk Driving Laws and Traffic Deaths</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using <tt>R</tt> for Introduction to Econometrics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. You can also see the annotations of others: click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="fixed-effects-regression" class="section level2">
<h2><span class="header-section-number">2.3</span> Fixed Effects Regression</h2>
<p>Consider the panel regression model</p>
<span class="math display">\[Y_{it} = \beta_0 + \beta_1 X_{it} + \beta_2 Z_i +  u_{it}\]</span> where the <span class="math inline">\(Z_i\)</span> are unobserved time-invariant heterogeneities across the entities <span class="math inline">\(i=1,\dots,n\)</span>. We aim to estimate <span class="math inline">\(\beta_1\)</span>, the effect on <span class="math inline">\(Y_i\)</span> of a change in <span class="math inline">\(X_i\)</span> holding constant <span class="math inline">\(Z_i\)</span>. Letting <span class="math inline">\(\alpha_i = \beta_0 + \beta_2 Z_i\)</span> we obtain the model
<span class="math display" id="eq:femodel">\[\begin{align}
Y_{it} = \alpha_i + \beta_1 X_{it} + u_{it} \tag{2.1}.
\end{align}\]</span>
Having individual specific intercepts <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>, where each of these can be understood as the fixed effect of entity <span class="math inline">\(i\)</span>, this model is called the <em>fixed effects model</em>. The variation in the <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(i=1,\dots,n\)</span> comes from the <span class="math inline">\(Z_i\)</span>. <a href="fixed-effects-regression.html#eq:femodel">(2.1)</a> can be rewritten as a regression model containing <span class="math inline">\(n-1\)</span> dummy regressors and a constant:
<span class="math display" id="eq:drmodel">\[\begin{align}
Y_{it} = \beta_0 + \beta_1 X_{it} + \gamma_2 D2_i + \gamma_3 D3_i + \cdots + \gamma_n Dn_i + u_{it} \tag{2.2}.
\end{align}\]</span>
<p>Model <a href="fixed-effects-regression.html#eq:drmodel">(2.2)</a> has <span class="math inline">\(n\)</span> different intercepts — one for every entity. <a href="fixed-effects-regression.html#eq:femodel">(2.1)</a> and <a href="fixed-effects-regression.html#eq:drmodel">(2.2)</a> are equivalent representations of the fixed effects model.</p>
<p>The fixed effects model can be generalized to contain more than just one determinant of <span class="math inline">\(Y\)</span> that is correlated with <span class="math inline">\(X\)</span> and changes over time. Key Concept 10.2 presents the generalized fixed effects regression model.</p>
<div class="keyconcept">
<h3 class="right">
Key Concept 10.2
</h3>
<h3 class="left">
The Fixed Effects Regression Model
</h3>
<p>The fixed effects regression model is</p>
<span class="math display" id="eq:gfemodel">\[\begin{align}
Y_{it} = \beta_1 X_{1,it} + \cdots + \beta_k X_{k,it} + \alpha_i + u_{it} \tag{2.3}
\end{align}\]</span>
<p>with <span class="math inline">\(i=1,\dots,n\)</span> and <span class="math inline">\(t=1,\dots,T\)</span>. The <span class="math inline">\(\alpha_i\)</span> are entity-specific intercepts that capture heterogeneities across entities. An equivalent representation of this model is given by</p>
<span class="math display" id="eq:gdrmodel">\[\begin{align}
Y_{it} = \beta_0 + \beta_1 X_{1,it} + \cdots + \beta_k X_{k,it} + \gamma_2 D2_i + \gamma_3 D3_i + \cdots + \gamma_n Dn_i  + u_{it} \tag{2.4}
\end{align}\]</span>
<p>where the <span class="math inline">\(D2_i,D3_i,\dots,Dn_i\)</span> are dummy variables.</p>
</div>
<div id="estimation-and-inference" class="section level3 unnumbered">
<h3>Estimation and Inference</h3>
<p>Software packages use a so-called “entity-demeaned” OLS algorithm which is computationally more efficient than estimating regression models with <span class="math inline">\(k+n\)</span> regressors as needed for models <a href="fixed-effects-regression.html#eq:gfemodel">(2.3)</a> and <a href="fixed-effects-regression.html#eq:gdrmodel">(2.4)</a>.</p>
Taking averages on both sides of <a href="fixed-effects-regression.html#eq:femodel">(2.1)</a> we obtain
<span class="math display">\[\begin{align*}
\frac{1}{n} \sum_{i=1}^n Y_{it} =&amp; \, \beta_1 \frac{1}{n} \sum_{i=1}^n X_{it} + \frac{1}{n} \sum_{i=1}^n a_i + \frac{1}{n} \sum_{i=1}^n u_{it} \\
\overline{Y} =&amp; \, \beta_1 \overline{X}_i + \alpha_i + \overline{u}_i. 
\end{align*}\]</span>
Subtraction from <a href="fixed-effects-regression.html#eq:femodel">(2.1)</a> yields
<span class="math display" id="eq:edols">\[\begin{align}
\begin{split}
Y_{it} - \overline{Y}_i =&amp; \, \beta_1(X_{it}-\overline{X}_i) + (u_{it} - \overline{u}_i) \\
\overset{\sim}{Y}_{it} =&amp; \, \beta_1 \overset{\sim}{X}_{it} + \overset{\sim}{u}_{it}. 
\end{split} \tag{2.5}
\end{align}\]</span>
<p>In this model, the OLS estimate of the parameter of interest <span class="math inline">\(\beta_1\)</span> is equal to the estimate obtained using <a href="fixed-effects-regression.html#eq:drmodel">(2.2)</a> — without the need to estimate <span class="math inline">\(n-1\)</span> dummies and an intercept.</p>
<p>We conclude that there are two ways of estimating <span class="math inline">\(\beta_1\)</span> in the fixed effects regression:</p>
<ol style="list-style-type: decimal">
<li><p>OLS of the dummy regression model as shown in <a href="fixed-effects-regression.html#eq:drmodel">(2.2)</a></p></li>
<li><p>OLS using the entity demeaned data as in <a href="fixed-effects-regression.html#eq:edols">(2.5)</a></p></li>
</ol>
<p>Provided the fixed effects regression assumptions stated in Key Concept 10.3 hold, the sampling distribution of the OLS estimator in the fixed effects regression model is normal in large samples. The variance of the estimates can be estimated and we can compute standard errors, <span class="math inline">\(t\)</span>-statistics and confidence intervals for coefficients. In the next section, we see how to estimate a fixed effects model using <tt>R</tt> and how to obtain a model summary that reports heteroskedasticity-robust standard errors. We leave aside complicated formulas of the estimators. See Chapter 10.5 and Appendix 10.2 of the book for a discussion of theoretical aspects.</p>
</div>
<div id="application-to-traffic-deaths" class="section level3 unnumbered">
<h3>Application to Traffic Deaths</h3>
Following Key Concept 10.2, the simple fixed effects model for estimation of the relation between traffic fatality rates and the beer taxes is
<span class="math display" id="eq:fatsemod">\[\begin{align}
FatalityRate_{it} = \beta_1 BeerTax_{it} + StateFixedEffects + u_{it}, \tag{2.6}
\end{align}\]</span>
<p>a regression of the traffic fatality rate on beer tax and 48 binary regressors — one for each federal state.</p>
<p>We can simply use the function <tt>lm()</tt> to obtain an estimate of <span class="math inline">\(\beta_1\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fatal_fe_lm_mod &lt;-<span class="st"> </span><span class="kw">lm</span>(fatal_rate <span class="op">~</span><span class="st"> </span>beertax <span class="op">+</span><span class="st"> </span>state <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> Fatalities)
fatal_fe_lm_mod</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fatal_rate ~ beertax + state - 1, data = Fatalities)
## 
## Coefficients:
## beertax  stateal  stateaz  statear  stateca  stateco  statect  statede  
## -0.6559   3.4776   2.9099   2.8227   1.9682   1.9933   1.6154   2.1700  
## statefl  statega  stateid  stateil  statein  stateia  stateks  stateky  
##  3.2095   4.0022   2.8086   1.5160   2.0161   1.9337   2.2544   2.2601  
## statela  stateme  statemd  statema  statemi  statemn  statems  statemo  
##  2.6305   2.3697   1.7712   1.3679   1.9931   1.5804   3.4486   2.1814  
## statemt  statene  statenv  statenh  statenj  statenm  stateny  statenc  
##  3.1172   1.9555   2.8769   2.2232   1.3719   3.9040   1.2910   3.1872  
## statend  stateoh  stateok  stateor  statepa  stateri  statesc  statesd  
##  1.8542   1.8032   2.9326   2.3096   1.7102   1.2126   4.0348   2.4739  
## statetn  statetx  stateut  statevt  stateva  statewa  statewv  statewi  
##  2.6020   2.5602   2.3137   2.5116   2.1874   1.8181   2.5809   1.7184  
## statewy  
##  3.2491</code></pre>
<p>As discussed in the previous section, it is also possible to estimate <span class="math inline">\(\beta_1\)</span> by applying OLS to the demeaned data, that is, to run the regression</p>
<p><span class="math display">\[\overset{\sim}{FatalityRate} = \beta_1 \overset{\sim}{BeerTax}_{it} + u_{it}. \]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># obtain demeaned data</span>
Fatalities_demeaned &lt;-<span class="st"> </span><span class="kw">with</span>(Fatalities,
            <span class="kw">data.frame</span>(<span class="dt">fatal_rate =</span> fatal_rate <span class="op">-</span><span class="st"> </span><span class="kw">ave</span>(fatal_rate, state),
            <span class="dt">beertaxs =</span> beertax <span class="op">-</span><span class="st"> </span><span class="kw">ave</span>(beertax, state)))

<span class="co"># estimate the regression</span>
<span class="kw">summary</span>(<span class="kw">lm</span>(fatal_rate <span class="op">~</span><span class="st"> </span>beertax <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> Fatalities_demeaned))</code></pre></div>
<p>The function <tt>ave</tt> is convenient for computing group averages. We use it to obtain state specific averages of the fatality rate and the beer tax.</p>
<p>Alternatively one may use <tt>plm()</tt> from the package with the same name.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install and load the &#39;plm&#39; package</span>
## install.packages(&quot;plm&quot;)
<span class="kw">library</span>(plm)</code></pre></div>
<p>As for <tt>lm()</tt> we have to specify the regression formula and the data to be used in our call of <tt>plm()</tt>. Additionally, it is required to pass a vector of names of entity and time ID variables to the argument <tt>index</tt>. For <tt>Fatalities</tt>, the ID variable for entities is named <tt>state</tt> and the time id variable is <tt>year</tt>. Since the fixed effects estimator is also called the <em>within estimator</em>, we set <tt>model = “within”</tt>. Finally, the function <tt>coeftest()</tt> allows to obtain inference based on robust standard errors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate the fixed effects regression with plm()</span>
fatal_fe_mod &lt;-<span class="st"> </span><span class="kw">plm</span>(fatal_rate <span class="op">~</span><span class="st"> </span>beertax, 
                    <span class="dt">data =</span> Fatalities,
                    <span class="dt">index =</span> <span class="kw">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>), 
                    <span class="dt">model =</span> <span class="st">&quot;within&quot;</span>)

<span class="co"># print summary using robust standard errors</span>
<span class="kw">coeftest</span>(fatal_fe_mod, <span class="dt">vcov. =</span> <span class="kw">vcovHC</span>(fatal_fe_mod, <span class="dt">type =</span> <span class="st">&quot;HC1&quot;</span>))</code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##         Estimate Std. Error t value Pr(&gt;|t|)  
## beertax -0.65587    0.28880  -2.271  0.02388 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The estimated coefficient is again <span class="math inline">\(-0.6559\)</span>. Note that <tt>plm()</tt> uses the entity-demeaned OLS algorithm and thus does not report dummy coefficients. The estimated regression function is</p>
<span class="math display" id="eq:efemod">\[\begin{align}
\widehat{FatalityRate} = -\underset{(0.29)}{0.66} \times BeerTax + StateFixedEffects. \tag{2.7}
\end{align}\]</span>
<p>The coefficient on <span class="math inline">\(BeerTax\)</span> is negative and significant. The interpretation is that the estimated reduction in traffic fatalities due to an increase in the real beer tax by <span class="math inline">\(\$1\)</span> is <span class="math inline">\(0.66\)</span> per <span class="math inline">\(10000\)</span> people, which is still pretty high. Although including state fixed effects eliminates the risk of a bias due to omitted factors that vary across states but not over time, we suspect that there are other omitted variables that vary over time and thus cause a bias.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="PDWTTP.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regression-with-time-fixed-effects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 1
},
"edit": null,
"download": ["URFITE.pdf"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
